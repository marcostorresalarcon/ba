<div class="px-20 pt-10">
  <div>
    <app-breadcrumb [breadcrumb]="breadcrumb()"></app-breadcrumb>
  </div>

  <div class="flex items-center justify-between mb-6">
    <div class="flex items-center gap-3">
      <p-button
        icon="pi pi-arrow-left"
        [text]="true"
        [rounded]="true"
        (onClick)="goBack()"
        ariaLabel="Volver"
        styleClass="p-2"
      ></p-button>
      <h1 class="text-3xl font-bold text-primary font-merriweather">Kitchen Information</h1>
    </div>

    <!-- Experience Display -->
    <div class="flex items-center gap-3">
      <label class="text-primary font-bold">Experience:</label>
      <span class="text-primary font-medium text-lg">{{ getCurrentExperience() | titlecase }}</span>
    </div>
  </div>

  <!-- Loader Overlay -->
  @if (loading$ | async) {
  <div class="fixed inset-0 z-[9999] flex items-center justify-center bg-black/40">
    <p-progressSpinner
      styleClass="w-12 h-12"
      strokeWidth="4"
      animationDuration="1s"
      ariaLabel="Cargando"
    ></p-progressSpinner>
  </div>
  }
</div>

<div class="px-20 pt-5 flex flex-col gap-4">
  <div class="flex gap-4">
    @for (option of kitchenTypeOptions; track option.value) { @let isSelected =
    getSelectedKitchenTypeValue() === option.value;
    <p-button
      [label]="option.label"
      (onClick)="handleKitchenTypeChange(option.value)"
      [unstyled]="true"
      [pt]="{
        root: {
          class: 'flex-1 px-4 py-3 font-bold transition-all',
          style: {
            borderRadius: '8px',
            backgroundColor: isSelected
              ? 'var(--brand-accent, #005a08)'
              : 'var(--surface-soft, #f5f7f4)',
            color: '#ffffff',
            border: 'none'
          }
        }
      }"
      [class.hover\:opacity-90]="true"
    ></p-button>
    }
  </div>

  <!-- Botón de Grabación de Voz -->
  <!-- <div class="flex justify-center mb-6">
    <button
      type="button"
      class="voice-record-btn text-center"
      [class.recording]="isRecording()"
      (click)="toggleVoiceRecording()"
      [disabled]="!isVoiceSupported()"
      title="{{
        isRecording() ? 'Detener grabación' : 'Iniciar grabación de voz'
      }}"
    >
      <div
        class="voice-btn-content text-center flex justify-center items-center"
      >
        <div class="microphone-icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
            class="mic-svg"
          >
            <path
              d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"
            />
            <path
              d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"
            />
          </svg>
        </div>>
        <span class="voice-btn-text text-center">{{
          isRecording() ? "Detener" : "Grabación de voz"
        }}</span>
      </div>

      <div class="sound-waves" *ngIf="isRecording()">
        <div class="wave wave-1"></div>
        <div class="wave wave-2"></div>
        <div class="wave wave-3"></div>
        <div class="wave wave-4"></div>
        <div class="wave wave-5"></div>
      </div>
    </button>
  </div> -->

  <div [formGroup]="form" class="flex flex-col gap-6 pb-10">
    <div class="flex flex-col gap-4 bg-gray2 rounded-xl p-4 py-6 border border-gray1">
      <h1 class="text-tertiary font-bold font-merriweather text-xl">Kitchen Information</h1>

      <div class="flex gap-4 w-full">
        <div class="flex gap-2 flex-col w-1/3">
          <label class="text-tertiary font-bold">Kitchen Square Footage (SF)</label>
          <p-inputNumber
            [formControl]="$any(form.get('kitchenSquareFootage'))"
            [min]="0"
            [step]="1"
            [useGrouping]="false"
            (onInput)="saveEstimate()"
            [showButtons]="false"
          ></p-inputNumber>
        </div>

        <div class="flex gap-2 flex-col w-1/3">
          <label class="text-tertiary font-bold">Kitchen Length (INCH)</label>
          <p-inputNumber
            [formControl]="$any(form.get('kitchenLength'))"
            [min]="0"
            [step]="1"
            [useGrouping]="false"
            (onInput)="saveEstimate()"
            styleClass="w-full"
            [showButtons]="false"
          ></p-inputNumber>
        </div>

        <div class="flex gap-2 flex-col w-1/3">
          <label class="text-tertiary font-bold">Kitchen Width (INCH)</label>
          <p-inputNumber
            [formControl]="$any(form.get('kitchenWidth'))"
            [min]="0"
            [step]="1"
            [useGrouping]="false"
            (onInput)="saveEstimate()"
            styleClass="w-full"
            [showButtons]="false"
          ></p-inputNumber>
        </div>
      </div>

      <!-- Ceiling Height -->
      <div class="w-full flex flex-col gap-2">
        <label class="text-tertiary font-bold">Ceiling Height</label>
        <div class="flex gap-4 items-center flex-wrap">
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="cellingHeight-8"
              name="cellingHeight"
              value="8 INCH"
              [formControl]="$any(form.get('cellingHeight'))"
              (click)="handleHeightSelection('cellingHeight', '8 INCH')"
              class="radio-input"
            />
            <label for="cellingHeight-8" class="text-tertiary cursor-pointer ml-1">8 INCH</label>
          </div>
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="cellingHeight-9"
              name="cellingHeight"
              value="9 INCH"
              [formControl]="$any(form.get('cellingHeight'))"
              (click)="handleHeightSelection('cellingHeight', '9 INCH')"
              class="radio-input"
            />
            <label for="cellingHeight-9" class="text-tertiary cursor-pointer ml-1">9 INCH</label>
          </div>
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="cellingHeight-10"
              name="cellingHeight"
              value="10 INCH"
              [formControl]="$any(form.get('cellingHeight'))"
              (click)="handleHeightSelection('cellingHeight', '10 INCH')"
              class="radio-input"
            />
            <label for="cellingHeight-10" class="text-tertiary cursor-pointer ml-1">10 INCH</label>
          </div>
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="cellingHeight-custom"
              name="cellingHeight"
              [value]="
                isCustomHeightSelected('cellingHeight')
                  ? getCustomHeightValue('cellingHeight')
                  : 'custom'
              "
              [formControl]="$any(form.get('cellingHeight'))"
              (click)="handleHeightSelection('cellingHeight', 'custom')"
              class="radio-input"
            />
            <label for="cellingHeight-custom" class="text-tertiary cursor-pointer ml-1"
              >Custom:</label
            >
            <p-inputNumber
              [formControl]="$any(form.get('cellingHeightCustom'))"
              [min]="0"
              [step]="0.1"
              [useGrouping]="false"
              styleClass="w-24"
              [showButtons]="false"
              placeholder="INCH"
            ></p-inputNumber>
          </div>
        </div>
      </div>

      <!-- Wall Cabinet Height -->
      <div class="w-full flex flex-col gap-2">
        <label class="text-tertiary font-bold">Wall Cabinet Height</label>
        <div class="flex gap-4 items-center flex-wrap">
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="wallCabinetHeight-30"
              name="wallCabinetHeight"
              value="30 INCH"
              [formControl]="$any(form.get('wallCabinetHeight'))"
              (click)="handleHeightSelection('wallCabinetHeight', '30 INCH')"
              class="radio-input"
            />
            <label for="wallCabinetHeight-30" class="text-tertiary cursor-pointer ml-1"
              >30 INCH</label
            >
          </div>
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="wallCabinetHeight-36"
              name="wallCabinetHeight"
              value="36 INCH"
              [formControl]="$any(form.get('wallCabinetHeight'))"
              (click)="handleHeightSelection('wallCabinetHeight', '36 INCH')"
              class="radio-input"
            />
            <label for="wallCabinetHeight-36" class="text-tertiary cursor-pointer ml-1"
              >36 INCH</label
            >
          </div>
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="wallCabinetHeight-42"
              name="wallCabinetHeight"
              value="42 INCH"
              [formControl]="$any(form.get('wallCabinetHeight'))"
              (click)="handleHeightSelection('wallCabinetHeight', '42 INCH')"
              class="radio-input"
            />
            <label for="wallCabinetHeight-42" class="text-tertiary cursor-pointer ml-1"
              >42 INCH</label
            >
          </div>
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="wallCabinetHeight-custom"
              name="wallCabinetHeight"
              [value]="
                isCustomHeightSelected('wallCabinetHeight')
                  ? getCustomHeightValue('wallCabinetHeight')
                  : 'custom'
              "
              [formControl]="$any(form.get('wallCabinetHeight'))"
              (click)="handleHeightSelection('wallCabinetHeight', 'custom')"
              class="radio-input"
            />
            <label for="wallCabinetHeight-custom" class="text-tertiary cursor-pointer ml-1"
              >Custom:</label
            >
            <p-inputNumber
              [formControl]="$any(form.get('wallCabinetHeightCustom'))"
              [min]="0"
              [step]="0.1"
              [useGrouping]="false"
              styleClass="w-24"
              [showButtons]="false"
              placeholder="INCH"
            ></p-inputNumber>
          </div>
        </div>
      </div>

      <!-- Stackers -->
      <div class="w-full flex flex-col gap-2">
        <label class="text-tertiary font-bold">Stackers</label>
        <div class="flex gap-4 items-center flex-wrap">
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="stackers-12"
              name="stackers"
              value="12 INCH"
              [formControl]="$any(form.get('stackers'))"
              (click)="handleHeightSelection('stackers', '12 INCH')"
              class="radio-input"
            />
            <label for="stackers-12" class="text-tertiary cursor-pointer ml-1">12 INCH</label>
          </div>
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="stackers-15"
              name="stackers"
              value="15 INCH"
              [formControl]="$any(form.get('stackers'))"
              (click)="handleHeightSelection('stackers', '15 INCH')"
              class="radio-input"
            />
            <label for="stackers-15" class="text-tertiary cursor-pointer ml-1">15 INCH</label>
          </div>
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="stackers-custom"
              name="stackers"
              [value]="
                isCustomHeightSelected('stackers') ? getCustomHeightValue('stackers') : 'custom'
              "
              [formControl]="$any(form.get('stackers'))"
              (click)="handleHeightSelection('stackers', 'custom')"
              class="radio-input"
            />
            <label for="stackers-custom" class="text-tertiary cursor-pointer ml-1">Custom:</label>
            <p-inputNumber
              [formControl]="$any(form.get('stackersCustom'))"
              [min]="0"
              [step]="0.1"
              [useGrouping]="false"
              styleClass="w-24"
              [showButtons]="false"
              placeholder="INCH"
            ></p-inputNumber>
          </div>
        </div>
      </div>

      <div class="flex gap-4 flex-col">
        <label class="text-tertiary font-bold">Cabinets to ceiling</label>
        <div class="flex gap-4">
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="isCabinetsToCelling-yes"
              name="isCabinetsToCelling"
              [checked]="form.get('isCabinetsToCelling')?.value === true"
              (change)="handleBooleanRadioChange('isCabinetsToCelling', true)"
              class="radio-input"
            />
            <label for="isCabinetsToCelling-yes" class="text-tertiary cursor-pointer ml-1"
              >Yes</label
            >
          </div>
          <div class="flex items-center gap-2">
            <input
              type="radio"
              id="isCabinetsToCelling-no"
              name="isCabinetsToCelling"
              [checked]="form.get('isCabinetsToCelling')?.value === false"
              (change)="handleBooleanRadioChange('isCabinetsToCelling', false)"
              class="radio-input"
            />
            <label for="isCabinetsToCelling-no" class="text-tertiary cursor-pointer ml-1">No</label>
          </div>
        </div>
      </div>

      <div class="flex flex-col gap-4 bg-gray2 rounded-xl p-4 py-6 border border-gray1">
        <h1 class="text-tertiary font-bold font-merriweather text-xl">Location Kitchen</h1>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3">
          <button
            type="button"
            class="location-btn"
            [class.selected]="(this.form.get('locationKitchen')?.value || []).includes('mainFloor')"
            (click)="selectLocationKitchen('mainFloor')"
          >
            Main Floor
          </button>
          <button
            type="button"
            class="location-btn"
            [class.selected]="(this.form.get('locationKitchen')?.value || []).includes('upstairs')"
            (click)="selectLocationKitchen('upstairs')"
          >
            Upstairs
          </button>
          <button
            type="button"
            class="location-btn"
            [class.selected]="(this.form.get('locationKitchen')?.value || []).includes('basement')"
            (click)="selectLocationKitchen('basement')"
          >
            Basement
          </button>
          <button
            type="button"
            class="location-btn"
            [class.selected]="
              (this.form.get('locationKitchen')?.value || []).includes('skyScraper')
            "
            (click)="selectLocationKitchen('skyScraper')"
          >
            Sky Scraper (tall building)
          </button>
        </div>
      </div>

      <div class="flex flex-col gap-4 bg-gray2 rounded-xl p-4 py-6 border border-gray1">
        <h1 class="text-tertiary font-bold font-merriweather text-xl">Subfloor</h1>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
          <button
            type="button"
            class="subfloor-btn"
            [class.selected]="(this.form.get('subFloor')?.value || []).includes('basementFinished')"
            (click)="selectSubFloor('basementFinished')"
          >
            Basement FINISHED
          </button>
          <button
            type="button"
            class="subfloor-btn"
            [class.selected]="
              (this.form.get('subFloor')?.value || []).includes('basementUnfinished')
            "
            (click)="selectSubFloor('basementUnfinished')"
          >
            Basement UNFINISHED
          </button>
          <button
            type="button"
            class="subfloor-btn"
            [class.selected]="(this.form.get('subFloor')?.value || []).includes('crawspace')"
            (click)="selectSubFloor('crawspace')"
          >
            Crawspace
          </button>
        </div>
      </div>

      <div class="flex flex-col gap-4 bg-gray2 rounded-xl p-4 py-6 border border-gray1">
        <h1 class="text-tertiary font-bold font-merriweather text-xl">Demolition</h1>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
          <!-- Primera fila: Kitchen Small, Kitchen Medium, Kitchen Large -->
          <button
            type="button"
            class="demolition-btn"
            [class.selected]="this.form.get('demolition')?.value === 'kitchenSmall'"
            [disabled]="true"
          >
            Kitchen Small
          </button>
          <button
            type="button"
            class="demolition-btn"
            [class.selected]="this.form.get('demolition')?.value === 'kitchenMedium'"
            [disabled]="true"
          >
            Kitchen Medium
          </button>
          <button
            type="button"
            class="demolition-btn"
            [class.selected]="this.form.get('demolition')?.value === 'kitchenLarge'"
            [disabled]="true"
          >
            Kitchen Large
          </button>

          <!-- Segunda fila: Servicios adicionales (control independiente eliminateDrywall) -->
          <button
            type="button"
            class="demolition-btn"
            [class.selected]="
              this.form.get('eliminateDrywall')?.value === 'eliminateDrywallPantryLoadBearing'
            "
            (click)="selectEliminateDrywall('eliminateDrywallPantryLoadBearing')"
          >
            Eliminate drywall pantry (load bearing)
          </button>
          <button
            type="button"
            class="demolition-btn"
            [class.selected]="
              this.form.get('eliminateDrywall')?.value === 'eliminateDrywallPantryNonLoadBearing'
            "
            (click)="selectEliminateDrywall('eliminateDrywallPantryNonLoadBearing')"
          >
            Eliminate drywall pantry (non load bearing)
          </button>
          <div class="flex items-center gap-3 bg-white rounded-lg px-3 py-2 border border-gray-200">
            <label class="text-tertiary font-bold">Dumpster on site</label>
            <div class="flex items-center gap-3">
              <label class="flex items-center gap-1">
                <input
                  type="radio"
                  [value]="true"
                  formControlName="dumpsterOnSite"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-1">
                <input
                  type="radio"
                  value=""
                  formControlName="dumpsterOnSite"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-gray-800 font-bold font-merriweather text-xl mb-2">Wall Demo</h1>

        <!-- Row 1: Remove wall inputs -->
        <div class="grid grid-cols-2 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Remove (1) wall - non load bearing</label>
            <div class="relative">
              <input
                (keyup)="saveEstimate()"
                type="number"
                formControlName="removeNonLoadWall"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Remove load bearing wall w/ LVL Beam (not recessed - exposed drywall beam)</label
            >
            <div class="relative">
              <input
                (keyup)="saveEstimate()"
                formControlName="removeLVLWall"
                type="number"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>

        <!-- Row 2: Remove metal wall input -->
        <div class="grid grid-cols-2 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Remove load bearing wall w/ Metal Beam (not recessed - exposed drywall beam)</label
            >
            <div class="relative">
              <input
                (keyup)="saveEstimate()"
                type="number"
                formControlName="removeMetalWall"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div></div>
          <!-- Empty column for layout -->
        </div>

        <!-- Row 3: Recessed beam and Additional support options -->
        <div class="grid grid-cols-2 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Recessed beam</label>
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  (change)="saveEstimate()"
                  name="recessedBeam"
                  type="radio"
                  formControlName="recessedBeam"
                  [value]="true"
                  class="tertiary"
                />
                <span class="text-gray-800">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  name="recessedBeam"
                  type="radio"
                  formControlName="recessedBeam"
                  value=""
                  class="tertiary"
                />
                <span class="text-gray-800">No</span>
              </label>
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Additional support in basement / crawl space</label
            >
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  name="supportBasement"
                  (change)="saveEstimate()"
                  type="radio"
                  formControlName="supportBasement"
                  [value]="true"
                  class="tertiary"
                />
                <span class="text-gray-800">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  name="supportBasement"
                  (change)="saveEstimate()"
                  type="radio"
                  formControlName="supportBasement"
                  value=""
                  class="tertiary"
                />
                <span class="text-gray-800">No</span>
              </label>
            </div>
          </div>
        </div>

        <!-- Row 4: Additional support on slab and Engineering Report -->
        <div class="grid grid-cols-2 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Additional support on slab</label>
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  (change)="saveEstimate()"
                  name="supportSlab"
                  type="radio"
                  formControlName="supportSlab"
                  [value]="true"
                  class="tertiary"
                />
                <span class="text-gray-800">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  name="supportSlab"
                  (change)="saveEstimate()"
                  type="radio"
                  formControlName="supportSlab"
                  value=""
                  class="tertiary"
                />
                <span class="text-gray-800">No</span>
              </label>
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Engineering Report (required for load bearing wall)</label
            >
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  name="engineeringReport"
                  (change)="saveEstimate()"
                  type="radio"
                  formControlName="engineeringReport"
                  [value]="true"
                  class="tertiary"
                />
                <span class="text-gray-800">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  name="engineeringReport"
                  (change)="saveEstimate()"
                  type="radio"
                  formControlName="engineeringReport"
                  value=""
                  class="tertiary"
                />
                <span class="text-gray-800">No</span>
              </label>
            </div>
          </div>
        </div>

        <!-- Row 5: Beam wrap and Demo electrico wiring -->
        <div class="grid grid-cols-2 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Beam: Wrap with cedar</label>
            <input
              (keyup)="saveEstimate()"
              type="number"
              inputmode="numeric"
              pattern="[0-9]*"
              min="0"
              step="1"
              formControlName="beamWrapCedar"
              class="w-full border border-gray-300 rounded-md py-3 px-2 bg-white"
            />
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Demo electrico wiring inside walls</label>
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  name="demoElectricWiring"
                  (change)="saveEstimate()"
                  type="radio"
                  formControlName="demoElectricWiring"
                  [value]="true"
                  class="tertiary"
                />
                <span class="text-gray-800">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  name="demoElectricWiring"
                  (change)="saveEstimate()"
                  type="radio"
                  formControlName="demoElectricWiring"
                  value=""
                  class="tertiary"
                />
                <span class="text-gray-800">No</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-gray-800 font-bold font-merriweather text-xl mb-2">Framing</h1>
        <div class="grid grid-cols-2 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Frame new wall</label>

            <!-- Yes/No options for Frame new wall -->
            <div class="flex gap-4 mb-2">
              <div class="flex items-center gap-2">
                <input
                  name="frameNewWall"
                  type="radio"
                  formControlName="frameNewWall"
                  value="yes"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
              </div>
              <div class="flex items-center gap-2">
                <input
                  name="frameNewWall"
                  type="radio"
                  formControlName="frameNewWall"
                  value=""
                  (change)="saveEstimate()"
                  checked
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>

            <div class="relative">
              <input
                (keyup)="saveEstimate()"
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="buildNewWall"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('frameNewWall')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Relocate wall</label>

            <!-- Yes/No options for Relocate wall -->
            <div class="flex gap-4 mb-2">
              <div class="flex items-center gap-2">
                <input
                  name="relocateWall"
                  type="radio"
                  formControlName="relocateWall"
                  value="yes"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
              </div>
              <div class="flex items-center gap-2">
                <input
                  name="relocateWall"
                  type="radio"
                  formControlName="relocateWall"
                  value=""
                  (change)="saveEstimate()"
                  checked
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>

            <div class="relative">
              <input
                (keyup)="saveEstimate()"
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="relocateWallQuantity"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('relocateWall')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>
      </div>

      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Electrical</h1>
        <!-- Electrical Options - Two Columns -->
        <div class="grid grid-cols-2 gap-4">
          <!-- Left Column -->
          <div class="flex flex-col gap-4">
            <!-- Under cabinet plug molds - Small Kitchen (4) -->
            @if (isSmallTypeSelected()) {
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >Under cabinet plug molds - Small Kitchen (4)</label
              >
              <div class="flex gap-4 items-center">
                <input
                  type="radio"
                  name="plugMoldSmall"
                  formControlName="plugMoldSmall"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  type="radio"
                  name="plugMoldSmall"
                  formControlName="plugMoldSmall"
                  value=""
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            }

            <!-- Under cabinet plug molds - Large Kitchen (10-12) -->
            @if (isLargeTypeSelected()) {
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >Under cabinet plug molds - Large Kitchen (10-12)</label
              >
              <div class="flex gap-4 items-center">
                <input
                  type="radio"
                  name="plugMoldLarge"
                  formControlName="plugMoldLarge"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  type="radio"
                  name="plugMoldLarge"
                  formControlName="plugMoldLarge"
                  value=""
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            }

            <!-- LED under cabinet lighting (15 LF) - Med Kitchen -->
            @if (isMediumTypeSelected()) {
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >LED under cabinet lighting (15 LF) - Med Kitchen</label
              >
              <div class="flex gap-4 items-center">
                <input
                  type="radio"
                  name="ledLightingMedium"
                  formControlName="ledLightingMedium"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  type="radio"
                  name="ledLightingMedium"
                  formControlName="ledLightingMedium"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            }

            <!-- Puck lights in glass cabinets (4) - Small Kitchen -->
            @if (isSmallTypeSelected()) {
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >Puck lights in glass cabinets (4) - Small Kitchen</label
              >
              <div class="flex gap-4 items-center">
                <input
                  type="radio"
                  name="puckLightsSmall"
                  formControlName="puckLightsSmall"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  type="radio"
                  name="puckLightsSmall"
                  formControlName="puckLightsSmall"
                  value=""
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            }

            <!-- Puck lights in glass cabinets (10) - Large Kitchen -->
            @if (isLargeTypeSelected()) {
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >Puck lights in glass cabinets (10) - Large Kitchen</label
              >
              <div class="flex gap-4 items-center">
                <input
                  type="radio"
                  name="puckLightsLarge"
                  formControlName="puckLightsLarge"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  type="radio"
                  name="puckLightsLarge"
                  formControlName="puckLightsLarge"
                  value=""
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            }
          </div>

          <!-- Right Column -->
          <div class="flex flex-col gap-4">
            <!-- Under cabinet plug molds - Medium Kitchen (6-8) -->
            @if (isMediumTypeSelected()) {
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >Under cabinet plug molds - Medium Kitchen (6-8)</label
              >
              <div class="flex gap-4 items-center">
                <input
                  type="radio"
                  name="plugMoldMedium"
                  formControlName="plugMoldMedium"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  type="radio"
                  name="plugMoldMedium"
                  formControlName="plugMoldMedium"
                  value=""
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            }

            <!-- LED under cabinet lighting (10 LF) - Small Kitchen -->
            @if (isSmallTypeSelected()) {
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >LED under cabinet lighting (10 LF) - Small Kitchen</label
              >
              <div class="flex gap-4 items-center">
                <input
                  type="radio"
                  name="ledLightingSmall"
                  formControlName="ledLightingSmall"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  type="radio"
                  name="ledLightingSmall"
                  formControlName="ledLightingSmall"
                  value=""
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            }

            <!-- LED under cabinet lighting (25 LF) - Larg Kitchen -->
            @if (isLargeTypeSelected()) {
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >LED under cabinet lighting (25 LF) - Larg Kitchen</label
              >
              <div class="flex gap-4 items-center">
                <input
                  type="radio"
                  name="ledLightingLarge"
                  formControlName="ledLightingLarge"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  type="radio"
                  name="ledLightingLarge"
                  formControlName="ledLightingLarge"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            }

            <!-- Puck lights in glass cabinets (6) - Medium Kitchen -->
            @if (isMediumTypeSelected()) {
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >Puck lights in glass cabinets (6) - Medium Kitchen</label
              >
              <div class="flex gap-4 items-center">
                <input
                  type="radio"
                  name="puckLightsMedium"
                  formControlName="puckLightsMedium"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  type="radio"
                  name="puckLightsMedium"
                  formControlName="puckLightsMedium"
                  value=""
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            }

            <!-- Install can light -->
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Install can light</label>
              <div class="flex gap-4 items-center">
                <input
                  type="radio"
                  name="canLightSize"
                  formControlName="canLightSize"
                  value="4"
                  (change)="onCanLightSizeChange()"
                />
                <span class="text-tertiary">4"</span>
                <input
                  type="radio"
                  name="canLightSize"
                  formControlName="canLightSize"
                  value="6"
                  (change)="onCanLightSizeChange()"
                />
                <span class="text-tertiary">6"</span>
              </div>
            </div>
          </div>
        </div>
        <!-- Row 1: After selection: Install can light / Install pendant lights / Relocate power for new Range location (220v) -->
        <div class="grid grid-cols-3 gap-3">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">After selection: Install can light</label>
            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="canLightQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Install pendant lights</label>
            <div class="relative">
              <input
                type="number"
                formControlName="pendantLights"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Relocate power for new Range location (220v)</label
            >
            <div class="relative">
              <input
                type="number"
                formControlName="relocateRange220"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>

        <!-- Row 2: Relocate power for new Range location (120v) / Relocate power for new Cooktop location (220v) / Relocate power for new Cooktop location (120v) -->
        <div class="grid grid-cols-3 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Relocate power for new Range location (120v)</label
            >
            <div class="relative">
              <input
                type="number"
                formControlName="relocateRange120"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Relocate power for new Cooktop location (220v)</label
            >
            <div class="relative">
              <input
                type="number"
                formControlName="relocateCooktop220"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Relocate power for new Cooktop location (120v)</label
            >
            <div class="relative">
              <input
                type="number"
                formControlName="relocateCooktop120"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>

        <!-- Row 3: Relocate power for new Double oven location (220v) / Relocate power for new Fridge location (120v) / Relocate power for new Hood insert location (120v) -->
        <div class="grid grid-cols-3 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Relocate power for new Double oven location (220v)</label
            >
            <div class="relative">
              <input
                type="number"
                formControlName="relocateDoubleOven220"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Relocate power for new Fridge location (120v)</label
            >
            <div class="relative">
              <input
                type="number"
                formControlName="relocateFridge120"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Relocate power for new Hood insert location (120v)</label
            >
            <div class="relative">
              <input
                type="number"
                formControlName="relocateHoodInsert120"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>

        <!-- Row 4: Relocate power for new Microwave location (120v) / Relocate power for new island (120v) / Run power for new Range (220v) -->
        <div class="grid grid-cols-3 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Relocate power for new Microwave location (120v)</label
            >
            <div class="relative">
              <input
                type="number"
                formControlName="relocateMicrowave120"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Relocate power for new island (120v)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="relocateIsland120"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Run power for new Range (220v)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="runPowerRange220"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>

        <!-- Row 5: Run power for new Range (120v) / Run power for new Cooktop (220v) / Run power for new Cooktop (120v) -->
        <div class="grid grid-cols-3 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Run power for new Range (120v)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="runPowerRange120"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Run power for new Cooktop (220v)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="runPowerCooktop220"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Run power for new Cooktop (120v)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="runPowerCooktop120"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>

        <!-- Row 6: Run power for new Double oven (220v) / Run power for new Hood insert (120v) / Run power for new Microwave (120v) -->
        <div class="grid grid-cols-3 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Run power for new Double oven (220v)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="runPowerDoubleOven220"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Run power for new Hood insert (120v)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="runPowerHoodInsert120"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Run power for new Microwave (120v)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="runPowerMicrowave120"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>

        <!-- Row 7: Run power for new island (110v) / Adding outlets (from existing power) / Adding outlets (run power) -->
        <div class="grid grid-cols-3 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Run power for new island (110v)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="runPowerIsland110"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Adding outlets (from existing power)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="addingOutletsExisting"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Adding outlets (run power)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="addingOutletsRunPower"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>

        <!-- Row 8: Add breaker -->
        <div class="grid grid-cols-3 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Add breaker</label>
            <div class="relative">
              <input
                type="number"
                formControlName="addBreaker"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div></div>
          <div></div>
        </div>

        <!-- Install air switch -->
        <div class="flex flex-col gap-2 mt-4">
          <label class="text-tertiary font-bold">Install air switch</label>
          <div class="flex gap-4 items-center">
            <input
              name="installAirSwitch"
              type="radio"
              formControlName="installAirSwitch"
              [value]="true"
              (change)="saveEstimate()"
            />
            <span class="text-tertiary">Yes</span>
            <input
              name="installAirSwitch"
              type="radio"
              formControlName="installAirSwitch"
              [value]="false"
              (change)="saveEstimate()"
            />
            <span class="text-tertiary">No</span>
          </div>
        </div>

        <!-- Reuse switch / Add new switch / Add new dimmer -->
        <div class="grid grid-cols-3 gap-4 mt-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Reuse switch</label>
            <div class="flex gap-4 items-center">
              <input
                name="reuseSwitch"
                type="radio"
                formControlName="reuseSwitch"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="reuseSwitch"
                type="radio"
                formControlName="reuseSwitch"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative mt-2">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="reuseSwitchQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('reuseSwitch')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Add new switch</label>
            <div class="flex gap-4 items-center">
              <input
                name="addNewSwitch"
                type="radio"
                formControlName="addNewSwitch"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="addNewSwitch"
                type="radio"
                formControlName="addNewSwitch"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative mt-2">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="addNewSwitchQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('addNewSwitch')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Add new dimmer</label>
            <div class="flex gap-4 items-center">
              <input
                name="addNewDimmer"
                type="radio"
                formControlName="addNewDimmer"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="addNewDimmer"
                type="radio"
                formControlName="addNewDimmer"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative mt-2">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="addNewDimmerQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('addNewDimmer')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
        </div>

        <!-- Keep switch on wall / Add subpanel 50 AMP / Add subpanel 100 AMP -->
        <div class="grid grid-cols-3 gap-4 mt-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Keep switch on wall</label>
            <div class="flex gap-4 items-center">
              <input
                name="keepSwitchOnWall"
                type="radio"
                formControlName="keepSwitchOnWall"
                [value]="true"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="keepSwitchOnWall"
                type="radio"
                formControlName="keepSwitchOnWall"
                [value]="false"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">No</span>
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Add subpanel 50 AMP</label>
            <div class="flex gap-4 items-center">
              <input
                name="addSubpanel50"
                type="radio"
                formControlName="addSubpanel50"
                [value]="true"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="addSubpanel50"
                type="radio"
                formControlName="addSubpanel50"
                [value]="false"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">No</span>
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Add subpanel 100 AMP</label>
            <div class="flex gap-4 items-center">
              <input
                name="addSubpanel100"
                type="radio"
                formControlName="addSubpanel100"
                [value]="true"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="addSubpanel100"
                type="radio"
                formControlName="addSubpanel100"
                [value]="false"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">No</span>
            </div>
          </div>
        </div>

        <!-- Upgrade panel -->
        <div class="flex flex-col gap-2 mt-4">
          <label class="text-tertiary font-bold">Upgrade panel</label>
          <div class="flex gap-4 items-center">
            <input
              name="upgradePanel"
              type="radio"
              formControlName="upgradePanel"
              value="noDisconnect"
              (change)="saveEstimate()"
            />
            <span class="text-tertiary">No disconnect inspection</span>
            <input
              name="upgradePanel"
              type="radio"
              formControlName="upgradePanel"
              value="withDisconnect"
              (change)="saveEstimate()"
            />
            <span class="text-tertiary">With disconnect no inspection</span>
          </div>
        </div>

        <!-- Relocate switches /outlets from wall removal / dishwasher wiring / Disposal wiring -->
        <div class="grid grid-cols-3 gap-4 mt-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold"
              >Relocate switches /outlets from wall removal</label
            >
            <div class="flex gap-4 items-center">
              <input
                name="relocateSwitchesOutlets"
                type="radio"
                formControlName="relocateSwitchesOutlets"
                [value]="true"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="relocateSwitchesOutlets"
                type="radio"
                formControlName="relocateSwitchesOutlets"
                [value]="false"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">No</span>
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">dishwasher wiring</label>

            <!-- Yes/No options for dishwasher wiring -->
            <div class="flex gap-4 items-center mb-2">
              <input
                name="dishwasherWiring"
                type="radio"
                formControlName="dishwasherWiring"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="dishwasherWiring"
                type="radio"
                formControlName="dishwasherWiring"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>

            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="dishwasherWiringQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('dishwasherWiring')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Disposal wiring</label>
            <div class="flex gap-4 items-center">
              <input
                name="disposalWiring"
                type="radio"
                formControlName="disposalWiring"
                [value]="true"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="disposalWiring"
                type="radio"
                formControlName="disposalWiring"
                [value]="false"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">No</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Plumbing -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Plumbing</h1>

        <!-- Run new drain and supply lines -->
        <div class="flex flex-col gap-2 mt-4">
          <label class="text-tertiary font-bold"
            >Run new drain and supply lines (toilet, dishwasher, sink, tub, washmachine)</label
          >
          <div class="flex gap-4 items-center">
            <input
              name="runNewDrainSupply"
              type="radio"
              formControlName="runNewDrainSupply"
              [value]="true"
              (change)="saveEstimate()"
            />
            <span class="text-tertiary">Yes</span>
            <input
              name="runNewDrainSupply"
              type="radio"
              formControlName="runNewDrainSupply"
              [value]="false"
              (change)="saveEstimate()"
            />
            <span class="text-tertiary">No</span>
          </div>
        </div>

        <!-- Relocate sink plumbing / Relocate fridge water line -->
        <div class="grid grid-cols-2 gap-4 mt-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Relocate sink plumbing</label>
            <div class="relative">
              <input
                type="number"
                formControlName="relocateSinkPlumbing"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Relocate fridge water line</label>
            <div class="relative">
              <input
                type="number"
                formControlName="relocateFridgeWaterLine"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>

        <!-- Install new fridge water box / Relocate dishwasher -->
        <div class="grid grid-cols-2 gap-4 mt-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Install new fridge water box</label>
            <div class="flex gap-4 items-center">
              <input
                name="installNewFridgeWaterBox"
                type="radio"
                formControlName="installNewFridgeWaterBox"
                [value]="true"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="installNewFridgeWaterBox"
                type="radio"
                formControlName="installNewFridgeWaterBox"
                [value]="false"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">No</span>
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Relocate dishwasher</label>
            <div class="flex gap-4 items-center">
              <input
                name="relocateDishwasher"
                type="radio"
                formControlName="relocateDishwasher"
                [value]="true"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="relocateDishwasher"
                type="radio"
                formControlName="relocateDishwasher"
                [value]="false"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">No</span>
            </div>
          </div>
        </div>

        <!-- install new water line dishwasher / Run new gas line -->
        <div class="grid grid-cols-2 gap-4 mt-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">install new water line dishwasher</label>
            <div class="relative">
              <input
                type="number"
                formControlName="installNewWaterLineDishwasher"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Run new gas line (Range, oven, dryer)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="runNewGasLine"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>

        <!-- Relocate gas line / Rework sink plumbing -->
        <div class="grid grid-cols-2 gap-4 mt-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Relocate gas line (Range, oven, dryer)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="relocateGasLine"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Rework sink plumbing</label>
            <div class="flex gap-4 items-center">
              <input
                name="reworkSinkPlumbing"
                type="radio"
                formControlName="reworkSinkPlumbing"
                [value]="true"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="reworkSinkPlumbing"
                type="radio"
                formControlName="reworkSinkPlumbing"
                [value]="false"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">No</span>
            </div>
          </div>
        </div>

        <!-- Run waterline and install new pot filler -->
        <div class="flex flex-col gap-2 mt-4">
          <label class="text-tertiary font-bold">Run waterline and install new pot filler</label>
          <div class="flex gap-4 items-center">
            <input
              name="runWaterlinePotFiller"
              type="radio"
              formControlName="runWaterlinePotFiller"
              [value]="true"
              (change)="saveEstimate()"
            />
            <span class="text-tertiary">Yes</span>
            <input
              name="runWaterlinePotFiller"
              type="radio"
              formControlName="runWaterlinePotFiller"
              [value]="false"
              (change)="saveEstimate()"
            />
            <span class="text-tertiary">No</span>
          </div>
        </div>

        <!-- Install faucet / Concrete cut/patch / Install new Insulation R13 -->
        <div class="grid grid-cols-3 gap-4 mt-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Install faucet</label>
            <div class="flex gap-4 items-center">
              <input
                name="installFaucet"
                type="radio"
                formControlName="installFaucet"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="installFaucet"
                type="radio"
                formControlName="installFaucet"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative mt-2">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="installFaucetQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('installFaucet')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Concrete cut / patch</label>
            <div class="flex gap-4 items-center">
              <input
                name="concreteCutPatch"
                type="radio"
                formControlName="concreteCutPatch"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="concreteCutPatch"
                type="radio"
                formControlName="concreteCutPatch"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative mt-2">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="concreteCutPatchQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('concreteCutPatch')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Install new Insulation R13</label>
            <div class="flex gap-4 items-center">
              <input
                name="installNewInsulationR13"
                type="radio"
                formControlName="installNewInsulationR13"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="installNewInsulationR13"
                type="radio"
                formControlName="installNewInsulationR13"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative mt-2">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="installNewInsulationR13Quantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('installNewInsulationR13')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >SF</span
              >
            </div>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Window -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Window</h1>

        <!-- Primera fila: Responsive 1/2/3 columnas -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">New window Double-hung</label>
            <div class="flex gap-4 items-center">
              <input
                name="newWindowDoubleHung"
                type="radio"
                formControlName="newWindowDoubleHung"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="newWindowDoubleHung"
                type="radio"
                formControlName="newWindowDoubleHung"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative mt-2">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="newWindowDoubleHungQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('newWindowDoubleHung')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">New window Picture window</label>
            <div class="flex gap-4 items-center">
              <input
                name="newWindowPictureWindow"
                type="radio"
                formControlName="newWindowPictureWindow"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="newWindowPictureWindow"
                type="radio"
                formControlName="newWindowPictureWindow"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative mt-2">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="newWindowPictureWindowQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('newWindowPictureWindow')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">New window casement</label>
            <div class="flex gap-4 items-center">
              <input
                name="newWindowCasement"
                type="radio"
                formControlName="newWindowCasement"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="newWindowCasement"
                type="radio"
                formControlName="newWindowCasement"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative mt-2">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="newWindowCasementQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('newWindowCasement')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
        </div>

        <!-- Segunda fila: Responsive 1/2/3 columnas (2 campos + 1 vacía en desktop) -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Window removal</label>
            <div class="flex gap-4 items-center">
              <input
                name="windowRemoval"
                type="radio"
                formControlName="windowRemoval"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="windowRemoval"
                type="radio"
                formControlName="windowRemoval"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative mt-2">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="windowRemovalQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('windowRemoval')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Relocate window</label>
            <div class="flex gap-4 items-center">
              <input
                name="relocateWindow"
                type="radio"
                formControlName="relocateWindow"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="relocateWindow"
                type="radio"
                formControlName="relocateWindow"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative mt-2">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="relocateWindowQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('relocateWindow')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
          <div class="hidden lg:flex flex-col gap-2">
            <!-- Columna vacía solo visible en desktop para mantener consistencia visual -->
          </div>
        </div>
      </div>

      <!-- Nueva sección de Cabinets -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Cabinets</h1>

        <!-- Basic (ROC, US Cab, etc) -->
        <div
          class="bg-white rounded-lg p-4 border border-gray-300 mb-4"
          *ngIf="getCurrentExperience() === 'basic'"
        >
          <h2 class="text-tertiary font-bold text-lg mb-4">Basic (ROC, US Cab, etc)</h2>

          <!-- Primera fila: 3 columnas -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">36" Upper Cabinets</label>
              <div class="flex gap-4 items-center">
                <input
                  name="basic36UpperCabinets"
                  type="radio"
                  formControlName="basic36UpperCabinets"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="basic36UpperCabinets"
                  type="radio"
                  formControlName="basic36UpperCabinets"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="basic36UpperCabinetsQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">42" Upper cabinets</label>
              <div class="flex gap-4 items-center">
                <input
                  name="basic42UpperCabinets"
                  type="radio"
                  formControlName="basic42UpperCabinets"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="basic42UpperCabinets"
                  type="radio"
                  formControlName="basic42UpperCabinets"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="basic42UpperCabinetsQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Base cabinet</label>
              <div class="flex gap-4 items-center">
                <input
                  name="basicBaseCabinet"
                  type="radio"
                  formControlName="basicBaseCabinet"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="basicBaseCabinet"
                  type="radio"
                  formControlName="basicBaseCabinet"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="basicBaseCabinetQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>
          </div>

          <!-- Segunda fila: 3 columnas -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Tall cabinets</label>
              <div class="flex gap-4 items-center">
                <input
                  name="basicTallCabinets"
                  type="radio"
                  formControlName="basicTallCabinets"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="basicTallCabinets"
                  type="radio"
                  formControlName="basicTallCabinets"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="basicTallCabinetsQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Trim work</label>
              <select
                formControlName="basicTrimWork"
                (change)="saveEstimate()"
                class="w-full border border-gray-300 rounded-md py-3 px-2 bg-gray-200"
              >
                <option value="">Select</option>
                <option value="small">Small</option>
                <option value="medium">Medium</option>
                <option value="large">Large</option>
              </select>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Installation</label>
              <select
                formControlName="basicInstallation"
                (change)="saveEstimate()"
                class="w-full border border-gray-300 rounded-md py-3 px-2 bg-gray-200"
              >
                <option value="">Select</option>
                <option value="small">Small</option>
                <option value="medium">Medium</option>
                <option value="large">Large</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Premium (JK, KCD, etc) -->
        <div
          class="bg-white rounded-lg p-4 border border-gray-300 mb-4"
          *ngIf="getCurrentExperience() === 'premium'"
        >
          <h2 class="text-tertiary font-bold text-lg mb-4">Premium (JK, KCD, etc)</h2>

          <!-- Primera fila: 3 columnas -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">30" Upper Cabinet</label>
              <div class="flex gap-4 items-center">
                <input
                  name="premium30UpperCabinet"
                  type="radio"
                  formControlName="premium30UpperCabinet"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="premium30UpperCabinet"
                  type="radio"
                  formControlName="premium30UpperCabinet"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="premium30UpperCabinetQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">36" Upper Cabinets</label>
              <div class="flex gap-4 items-center">
                <input
                  name="premium36UpperCabinets"
                  type="radio"
                  formControlName="premium36UpperCabinets"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="premium36UpperCabinets"
                  type="radio"
                  formControlName="premium36UpperCabinets"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="premium36UpperCabinetsQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">42" Upper Cabinets</label>
              <div class="flex gap-4 items-center">
                <input
                  name="premium42UpperCabinets"
                  type="radio"
                  formControlName="premium42UpperCabinets"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="premium42UpperCabinets"
                  type="radio"
                  formControlName="premium42UpperCabinets"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="premium42UpperCabinetsQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>
          </div>

          <!-- Segunda fila: 2 columnas -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Base Cabinet</label>
              <div class="flex gap-4 items-center">
                <input
                  name="premiumBaseCabinet"
                  type="radio"
                  formControlName="premiumBaseCabinet"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="premiumBaseCabinet"
                  type="radio"
                  formControlName="premiumBaseCabinet"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="premiumBaseCabinetQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Tall Cabinets</label>
              <div class="flex gap-4 items-center">
                <input
                  name="premiumTallCabinets"
                  type="radio"
                  formControlName="premiumTallCabinets"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="premiumTallCabinets"
                  type="radio"
                  formControlName="premiumTallCabinets"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="premiumTallCabinetsQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>
          </div>

          <!-- Tercera fila: 2 columnas -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Trim work</label>
              <select
                formControlName="premiumTrimWork"
                (change)="saveEstimate()"
                class="w-full border border-gray-300 rounded-md py-3 px-2 bg-gray-200"
              >
                <option value="">Select</option>
                <option value="small">Small</option>
                <option value="medium">Medium</option>
                <option value="large">Large</option>
              </select>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Installation</label>
              <select
                formControlName="premiumInstallation"
                (change)="saveEstimate()"
                class="w-full border border-gray-300 rounded-md py-3 px-2 bg-gray-200"
              >
                <option value="">Select</option>
                <option value="small">Small</option>
                <option value="medium">Medium</option>
                <option value="large">Large</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Luxury (Custom) -->
        <div
          class="bg-white rounded-lg p-4 border border-gray-300 mb-4"
          *ngIf="getCurrentExperience() === 'luxury'"
        >
          <h2 class="text-tertiary font-bold text-lg mb-4">Luxury (Custom)</h2>

          <!-- Primera fila: 3 columnas -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">30" Upper Cabinet</label>
              <div class="flex gap-4 items-center">
                <input
                  name="luxury30UpperCabinet"
                  type="radio"
                  formControlName="luxury30UpperCabinet"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="luxury30UpperCabinet"
                  type="radio"
                  formControlName="luxury30UpperCabinet"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">36" Upper Cabinets</label>
              <div class="flex gap-4 items-center">
                <input
                  name="luxury36UpperCabinets"
                  type="radio"
                  formControlName="luxury36UpperCabinets"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="luxury36UpperCabinets"
                  type="radio"
                  formControlName="luxury36UpperCabinets"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">42" Upper Cabinets</label>
              <div class="flex gap-4 items-center">
                <input
                  name="luxury42UpperCabinets"
                  type="radio"
                  formControlName="luxury42UpperCabinets"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="luxury42UpperCabinets"
                  type="radio"
                  formControlName="luxury42UpperCabinets"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
          </div>

          <!-- Segunda fila: 2 columnas -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Base Cabinet</label>
              <div class="flex gap-4 items-center">
                <input
                  name="luxuryBaseCabinet"
                  type="radio"
                  formControlName="luxuryBaseCabinet"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="luxuryBaseCabinet"
                  type="radio"
                  formControlName="luxuryBaseCabinet"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Trim Work</label>
              <select
                formControlName="luxuryTrimWork"
                (change)="saveEstimate()"
                class="w-full border border-gray-300 rounded-md py-3 px-2 bg-gray-200"
              >
                <option value="">Select</option>
                <option value="small">Small</option>
                <option value="medium">Medium</option>
                <option value="large">Large</option>
              </select>
            </div>
          </div>

          <!-- Tercera fila: 1 columna -->
          <div class="grid grid-cols-1 gap-4 mt-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Installation</label>
              <select
                formControlName="luxuryInstallation"
                (change)="saveEstimate()"
                class="w-full border border-gray-300 rounded-md py-3 px-2 bg-gray-200"
              >
                <option value="">Select</option>
                <option value="small">Small</option>
                <option value="medium">Medium</option>
                <option value="large">Large</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Stackers with glass -->
        <div class="bg-white rounded-lg p-4 border border-gray-300 mb-4">
          <h2 class="text-tertiary font-bold text-lg mb-4">Stackers with glass</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">12" Stackers con glass</label>
              <div class="flex gap-4 items-center">
                <input
                  name="stackersWithGlass12"
                  type="radio"
                  formControlName="stackersWithGlass12"
                  value="yes"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="stackersWithGlass12"
                  type="radio"
                  formControlName="stackersWithGlass12"
                  value=""
                  (change)="saveEstimate()"
                  checked
                />
                <span class="text-tertiary">No</span>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="stackersWithGlass12Quantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                [class.bg-gray-200]="form.get('stackersWithGlass12')?.value !== 'yes'"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white mt-2"
              />
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">15" Stackers con glass</label>
              <div class="flex gap-4 items-center">
                <input
                  name="stackersWithGlass15"
                  type="radio"
                  formControlName="stackersWithGlass15"
                  value="yes"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="stackersWithGlass15"
                  type="radio"
                  formControlName="stackersWithGlass15"
                  value=""
                  (change)="saveEstimate()"
                  checked
                />
                <span class="text-tertiary">No</span>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="stackersWithGlass15Quantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                [class.bg-gray-200]="form.get('stackersWithGlass15')?.value !== 'yes'"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white mt-2"
              />
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">18" Stackers con glass</label>
              <div class="flex gap-4 items-center">
                <input
                  name="stackersWithGlass18"
                  type="radio"
                  formControlName="stackersWithGlass18"
                  value="yes"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="stackersWithGlass18"
                  type="radio"
                  formControlName="stackersWithGlass18"
                  value=""
                  (change)="saveEstimate()"
                  checked
                />
                <span class="text-tertiary">No</span>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="stackersWithGlass18Quantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                [class.bg-gray-200]="form.get('stackersWithGlass18')?.value !== 'yes'"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white mt-2"
              />
            </div>
          </div>
        </div>

        <!-- Stackers without glass -->
        <div class="bg-white rounded-lg p-4 border border-gray-300 mb-4">
          <h2 class="text-tertiary font-bold text-lg mb-4">Stackers without glass</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">12" Stackers</label>
              <div class="flex gap-4 items-center">
                <input
                  name="stackersWithoutGlass12"
                  type="radio"
                  formControlName="stackersWithoutGlass12"
                  value="yes"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="stackersWithoutGlass12"
                  type="radio"
                  formControlName="stackersWithoutGlass12"
                  value=""
                  (change)="saveEstimate()"
                  checked
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="stackersWithoutGlass12Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  [class.bg-gray-200]="form.get('stackersWithoutGlass12')?.value !== 'yes'"
                  class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">15" Stackers</label>
              <div class="flex gap-4 items-center">
                <input
                  name="stackersWithoutGlass15"
                  type="radio"
                  formControlName="stackersWithoutGlass15"
                  value="yes"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="stackersWithoutGlass15"
                  type="radio"
                  formControlName="stackersWithoutGlass15"
                  value=""
                  (change)="saveEstimate()"
                  checked
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="stackersWithoutGlass15Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  [class.bg-gray-200]="form.get('stackersWithoutGlass15')?.value !== 'yes'"
                  class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">18" Stackers</label>
              <div class="flex gap-4 items-center">
                <input
                  name="stackersWithoutGlass18"
                  type="radio"
                  formControlName="stackersWithoutGlass18"
                  value="yes"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="stackersWithoutGlass18"
                  type="radio"
                  formControlName="stackersWithoutGlass18"
                  value=""
                  (change)="saveEstimate()"
                  checked
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="stackersWithoutGlass18Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  [class.bg-gray-200]="form.get('stackersWithoutGlass18')?.value !== 'yes'"
                  class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>
          </div>

          <!-- Segunda fila: 3 columnas -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">36" - 42" Wide Pocket Doors</label>
              <div class="flex gap-4 items-center">
                <input
                  name="widePocketDoors"
                  type="radio"
                  formControlName="widePocketDoors"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="widePocketDoors"
                  type="radio"
                  formControlName="widePocketDoors"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
              <div class="relative mt-2">
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="widePocketDoorsQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Glass Doors (Router and glass included)</label>
              <div class="relative">
                <input
                  type="number"
                  formControlName="glassDoors"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >EA</span
                >
              </div>
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Hardware Installation</label>
              <select
                formControlName="hardwareInstallation"
                (change)="saveEstimate()"
                class="w-full border border-gray-300 rounded-md py-3 px-2 bg-gray-200"
              >
                <option value="">Select</option>
                <option value="small">Small</option>
                <option value="medium">Medium</option>
                <option value="large">Large</option>
              </select>
            </div>
          </div>

          <!-- Tercera fila: 3 columnas -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >Painting Cabinets (existing paint color)</label
              >
              <div class="relative">
                <input
                  type="number"
                  formControlName="paintingCabinetsPaintColor"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >LF</span
                >
              </div>
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >Painting Cabinets (existing stain color)</label
              >
              <div class="relative">
                <input
                  type="number"
                  formControlName="paintingCabinetsStainColor"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-2 px-2 pr-8 bg-white"
                />
                <span
                  class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                  >LF</span
                >
              </div>
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Hardware Installation (existing holes)</label>
              <div class="flex gap-4 items-center">
                <input
                  name="hardwareInstallationExistingHoles"
                  type="radio"
                  formControlName="hardwareInstallationExistingHoles"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="hardwareInstallationExistingHoles"
                  type="radio"
                  formControlName="hardwareInstallationExistingHoles"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
          </div>

          <!-- Cuarta fila: 1 columna -->
          <div class="grid grid-cols-1 gap-4 mt-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Hardware Installation (existing holes)</label>
              <div class="flex gap-4 items-center">
                <input
                  name="hardwareInstallationPuttyDrill"
                  type="radio"
                  formControlName="hardwareInstallationPuttyDrill"
                  [value]="true"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">Yes</span>
                <input
                  name="hardwareInstallationPuttyDrill"
                  type="radio"
                  formControlName="hardwareInstallationPuttyDrill"
                  [value]="false"
                  (change)="saveEstimate()"
                />
                <span class="text-tertiary">No</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Shelving -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Shelving</h1>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Glass Shelves 1/2"</label>
            <div class="relative">
              <input
                type="number"
                formControlName="glassShelvesHalf"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >EA</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Floating (match cabinets)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="floatingShelvesMatch"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Floating (custom)</label>
            <div class="relative">
              <input
                type="number"
                formControlName="floatingShelvesCustom"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>
      </div>

      <!-- Se eliminó bloque duplicado de Ventilation Hood -->

      <!-- Nueva sección de Wood Hood Vent -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Wood Hood Vent</h1>

        <div class="flex gap-4 flex-wrap">
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="this.form.get('woodHoodVentSize')?.value === '30 INCH'"
            [class.text-white]="this.form.get('woodHoodVentSize')?.value === '30 INCH'"
            [class.bg-white]="this.form.get('woodHoodVentSize')?.value !== '30 INCH'"
            [class.text-tertiary]="this.form.get('woodHoodVentSize')?.value !== '30 INCH'"
            (click)="select('woodHoodVentSize', '30 INCH')"
          >
            30 INCH
          </button>
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="this.form.get('woodHoodVentSize')?.value === '36 INCH'"
            [class.text-white]="this.form.get('woodHoodVentSize')?.value === '36 INCH'"
            [class.bg-white]="this.form.get('woodHoodVentSize')?.value !== '36 INCH'"
            [class.text-tertiary]="this.form.get('woodHoodVentSize')?.value !== '36 INCH'"
            (click)="select('woodHoodVentSize', '36 INCH')"
          >
            36 INCH
          </button>
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="this.form.get('woodHoodVentSize')?.value === '48 INCH'"
            [class.text-white]="this.form.get('woodHoodVentSize')?.value === '48 INCH'"
            [class.bg-white]="this.form.get('woodHoodVentSize')?.value !== '48 INCH'"
            [class.text-tertiary]="this.form.get('woodHoodVentSize')?.value !== '48 INCH'"
            (click)="select('woodHoodVentSize', '48 INCH')"
          >
            48 INCH
          </button>
          <button
            type="button"
            class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="this.form.get('woodHoodVentSize')?.value === '60 INCH'"
            [class.text-white]="this.form.get('woodHoodVentSize')?.value === '60 INCH'"
            [class.bg-white]="this.form.get('woodHoodVentSize')?.value !== '60 INCH'"
            [class.text-tertiary]="this.form.get('woodHoodVentSize')?.value !== '60 INCH'"
            (click)="select('woodHoodVentSize', '60 INCH')"
          >
            60 INCH
          </button>
        </div>

        <!-- Campo Plaster -->
        <div class="flex flex-col gap-2 mt-4">
          <label class="text-tertiary font-bold">Plaster</label>
          <div class="flex gap-4 items-center">
            <input
              name="plaster"
              type="radio"
              formControlName="plaster"
              [value]="true"
              (change)="saveEstimate()"
            />
            <span class="text-tertiary">Yes</span>
            <input
              name="plaster"
              type="radio"
              formControlName="plaster"
              [value]="false"
              (change)="saveEstimate()"
            />
            <span class="text-tertiary">No</span>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Countertops -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Countertops</h1>

        <!-- Primera fila: Quartz (izquierda) y Quartzite (derecha) -->
        <div class="grid grid-cols-2 gap-4">
          <!-- Quartz - Mitad izquierda -->
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Quartz</label>
            <div class="flex gap-4 items-center">
              <input
                name="countertopsQuartz"
                type="radio"
                formControlName="countertopsQuartz"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="countertopsQuartz"
                type="radio"
                formControlName="countertopsQuartz"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="countertopsQuartzQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                [class.bg-gray-200]="form.get('countertopsQuartz')?.value !== 'yes'"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >SF</span
              >
            </div>
          </div>
          <!-- Quartzite - Mitad derecha -->
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Quartzite</label>
            <div class="flex gap-4 items-center">
              <input
                name="countertopsQuartzite"
                type="radio"
                formControlName="countertopsQuartzite"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="countertopsQuartzite"
                type="radio"
                formControlName="countertopsQuartzite"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="countertopsQuartziteQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                [class.bg-gray-200]="form.get('countertopsQuartzite')?.value !== 'yes'"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >SF</span
              >
            </div>
          </div>
        </div>

        <!-- Segunda fila: Granite (izquierda) y Marble (derecha) -->
        <div class="grid grid-cols-2 gap-4">
          <!-- Granite - Mitad izquierda -->
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Granite</label>
            <div class="flex gap-4 items-center">
              <input
                name="countertopsGranite"
                type="radio"
                formControlName="countertopsGranite"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="countertopsGranite"
                type="radio"
                formControlName="countertopsGranite"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="countertopsGraniteQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                [class.bg-gray-200]="form.get('countertopsGranite')?.value !== 'yes'"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >SF</span
              >
            </div>
          </div>
          <!-- Marble - Mitad derecha -->
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Marble</label>
            <div class="flex gap-4 items-center">
              <input
                name="countertopsMarble"
                type="radio"
                formControlName="countertopsMarble"
                value="yes"
                (change)="saveEstimate()"
              />
              <span class="text-tertiary">Yes</span>
              <input
                name="countertopsMarble"
                type="radio"
                formControlName="countertopsMarble"
                value=""
                (change)="saveEstimate()"
                checked
              />
              <span class="text-tertiary">No</span>
            </div>
            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="countertopsMarbleQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                [class.bg-gray-200]="form.get('countertopsMarble')?.value !== 'yes'"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >SF</span
              >
            </div>
          </div>
        </div>

        <!-- Photo/Video Upload with Individual Comments -->
        <div class="mt-6">
          <h3 class="text-tertiary font-bold text-lg mb-4">Photo/Video Upload</h3>

          <!-- Upload Section (homogenized with Backsplash Other) -->
          <div class="grid grid-cols-5 gap-4 mb-6">
            <div class="col-span-1">
              <div class="relative">
                <input
                  type="file"
                  #fileInput
                  (change)="onCountertopsFileSelected($event)"
                  accept="image/*,video/*"
                  multiple
                  class="hidden"
                />
                <div
                  class="border border-dashed border-gray-400 rounded-lg bg-white aspect-square flex items-center justify-center cursor-pointer hover:bg-gray-50 transition-colors overflow-hidden"
                  (click)="fileInput.click()"
                  (keyup.enter)="fileInput.click()"
                  (keyup.space)="fileInput.click()"
                  tabindex="0"
                  role="button"
                >
                  <div *ngIf="getUploadPreviewUrl()" class="w-full h-full relative">
                    <img
                      *ngIf="selectedFiles.length > 0 && selectedFiles[0].type.startsWith('image/')"
                      [src]="getUploadPreviewUrl()"
                      [alt]="selectedFiles[0].name"
                      class="w-full h-full object-cover"
                    />
                    <video
                      *ngIf="selectedFiles.length > 0 && selectedFiles[0].type.startsWith('video/')"
                      [src]="getUploadPreviewUrl()"
                      class="w-full h-full object-cover"
                      muted
                    ></video>
                    <div
                      *ngIf="selectedFiles.length > 1"
                      class="absolute top-1 right-1 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded"
                    >
                      +{{ selectedFiles.length - 1 }}
                    </div>
                  </div>
                  <div *ngIf="!getUploadPreviewUrl()" class="text-center">
                    <svg
                      class="w-6 h-6 text-gray-400 mx-auto mb-1"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                      aria-hidden="true"
                      focusable="false"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                      />
                    </svg>
                    <p class="text-xs text-gray-500">Click to upload</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-span-4 flex flex-col gap-2">
              <textarea
                #commentInput
                placeholder="Enter comment for the selected files..."
                class="w-full border border-gray-300 rounded-lg p-3 bg-white resize-none"
                rows="3"
              ></textarea>
              <button
                type="button"
                class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold hover:bg-gray-50"
                (click)="
                  addCountertopsFilesWithComment(commentInput.value); commentInput.value = ''
                "
              >
                Add Files with Comment
              </button>
            </div>
          </div>

          <!-- Display Uploaded Files -->
          <div *ngIf="getCountertopsFiles().length > 0" class="mt-6">
            <h4 class="text-tertiary font-bold text-md mb-3">Uploaded Files</h4>
            <div class="space-y-4">
              <div
                *ngFor="let file of getCountertopsFiles(); trackBy: trackByCountertopsFile"
                class="bg-white border border-gray-300 rounded-lg p-4 flex gap-4"
              >
                <!-- File Preview -->
                <div class="flex-shrink-0">
                  <img
                    *ngIf="file.type === 'image'"
                    [src]="file.url"
                    [alt]="file.name"
                    class="w-24 h-24 object-cover rounded-md"
                  />
                  <video
                    *ngIf="file.type === 'video'"
                    [src]="file.url"
                    class="w-24 h-24 object-cover rounded-md"
                    controls
                  ></video>
                </div>

                <!-- File Info and Comment -->
                <div class="flex-grow flex flex-col gap-3">
                  <!-- Comment -->
                  <div class="flex-grow">
                    <label class="text-xs font-medium text-gray-700 block mb-1">Comment:</label>
                    <textarea
                      [value]="file.comment"
                      (input)="updateCountertopsFileCommentFromEvent(file.id, $event)"
                      placeholder="Add a comment..."
                      class="w-full text-xs border border-gray-300 rounded p-2 resize-none"
                      rows="2"
                    ></textarea>
                  </div>
                </div>

                <!-- Remove Button -->
                <div class="flex-shrink-0 flex items-center">
                  <button
                    type="button"
                    (click)="removeCountertopsFile(file.id)"
                    class="p-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors flex items-center justify-center"
                    title="Remove file"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke-width="1.5"
                      stroke="currentColor"
                      class="size-6"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"
                      />
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Countertop Template fee -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">
          Countertop Template fee
        </h1>

        <div class="grid grid-cols-3 gap-3">
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="this.form.get('countertopTemplateFeeSmall')?.value === true"
            [class.text-white]="this.form.get('countertopTemplateFeeSmall')?.value === true"
            [class.bg-white]="this.form.get('countertopTemplateFeeSmall')?.value !== true"
            [class.text-tertiary]="this.form.get('countertopTemplateFeeSmall')?.value !== true"
            [disabled]="true"
          >
            Small Kitchen
          </button>
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="this.form.get('countertopTemplateFeeMedium')?.value === true"
            [class.text-white]="this.form.get('countertopTemplateFeeMedium')?.value === true"
            [class.bg-white]="this.form.get('countertopTemplateFeeMedium')?.value !== true"
            [class.text-tertiary]="this.form.get('countertopTemplateFeeMedium')?.value !== true"
            [disabled]="true"
          >
            Medium Kitchen
          </button>
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="this.form.get('countertopTemplateFeeLarge')?.value === true"
            [class.text-white]="this.form.get('countertopTemplateFeeLarge')?.value === true"
            [class.bg-white]="this.form.get('countertopTemplateFeeLarge')?.value !== true"
            [class.text-tertiary]="this.form.get('countertopTemplateFeeLarge')?.value !== true"
            [disabled]="true"
          >
            Large Kitchen
          </button>
        </div>
      </div>

      <!-- Nueva sección de Edging -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Edging</h1>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Eased and polished</label>
            <div class="flex gap-4 mb-2">
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingEasedPolished"
                  value="yes"
                  formControlName="edgingEasedPolished"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingEasedPolished"
                  value=""
                  formControlName="edgingEasedPolished"
                  class="w-4 h-4"
                  checked
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="edgingEasedPolishedQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('edgingEasedPolished')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Bevel</label>
            <div class="flex gap-4 mb-2">
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingBevel"
                  value="yes"
                  formControlName="edgingBevel"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingBevel"
                  value=""
                  formControlName="edgingBevel"
                  class="w-4 h-4"
                  checked
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="edgingBevelQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('edgingBevel')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Bullnose</label>
            <div class="flex gap-4 mb-2">
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingBullnose"
                  value="yes"
                  formControlName="edgingBullnose"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingBullnose"
                  value=""
                  formControlName="edgingBullnose"
                  class="w-4 h-4"
                  checked
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="edgingBullnoseQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('edgingBullnose')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Half Bullnose</label>
            <div class="flex gap-4 mb-2">
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingHalfBullnose"
                  value="yes"
                  formControlName="edgingHalfBullnose"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingHalfBullnose"
                  value=""
                  formControlName="edgingHalfBullnose"
                  class="w-4 h-4"
                  checked
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="edgingHalfBullnoseQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('edgingHalfBullnose')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Ogee</label>
            <div class="flex gap-4 mb-2">
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingOgee"
                  value="yes"
                  formControlName="edgingOgee"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingOgee"
                  value=""
                  formControlName="edgingOgee"
                  class="w-4 h-4"
                  checked
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="edgingOgeeQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('edgingOgee')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Mitered edge (thick edge)</label>
            <div class="flex gap-4 mb-2">
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingMiteredEdge"
                  value="yes"
                  formControlName="edgingMiteredEdge"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="edgingMiteredEdge"
                  value=""
                  formControlName="edgingMiteredEdge"
                  class="w-4 h-4"
                  checked
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
            <div class="relative">
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="edgingMiteredEdgeQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-2 pr-8 bg-white"
                [class.bg-gray-200]="form.get('edgingMiteredEdge')?.value !== 'yes'"
              />
              <span
                class="absolute right-2 top-1/2 transform -translate-y-1/2 font-bold text-tertiary"
                >LF</span
              >
            </div>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Cutouts -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Cutouts</h1>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Sink and Faucet cutout</label>
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  name="cutoutsSinkFaucet"
                  type="radio"
                  formControlName="cutoutsSinkFaucet"
                  [value]="true"
                  (change)="saveEstimate()"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  name="cutoutsSinkFaucet"
                  type="radio"
                  formControlName="cutoutsSinkFaucet"
                  [value]="false"
                  (change)="saveEstimate()"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Cooktop cutout</label>
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  name="cutoutsCooktop"
                  type="radio"
                  formControlName="cutoutsCooktop"
                  [value]="true"
                  (change)="saveEstimate()"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  name="cutoutsCooktop"
                  type="radio"
                  formControlName="cutoutsCooktop"
                  [value]="false"
                  (change)="saveEstimate()"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
          </div>
        </div>

        <div class="flex flex-col gap-2">
          <label class="text-tertiary font-bold">Additional cuts</label>
          <input
            type="number"
            inputmode="numeric"
            pattern="[0-9]*"
            min="0"
            step="1"
            formControlName="cutoutsAdditional"
            (keyup)="saveEstimate()"
            placeholder="Entry additional cuts details"
            class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
          />
        </div>
      </div>

      <!-- Nueva sección de Sink Selection -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Sink Selection</h1>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="isSinkSelected('sinkStainlessSteelUndermount')"
            [class.text-white]="isSinkSelected('sinkStainlessSteelUndermount')"
            [class.bg-white]="!isSinkSelected('sinkStainlessSteelUndermount')"
            [class.text-tertiary]="!isSinkSelected('sinkStainlessSteelUndermount')"
            (click)="selectSink('sinkStainlessSteelUndermount')"
          >
            Stainless Steel - Undermount
          </button>
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="isSinkSelected('sinkBlancoUndermount')"
            [class.text-white]="isSinkSelected('sinkBlancoUndermount')"
            [class.bg-white]="!isSinkSelected('sinkBlancoUndermount')"
            [class.text-tertiary]="!isSinkSelected('sinkBlancoUndermount')"
            (click)="selectSink('sinkBlancoUndermount')"
          >
            Blanco Undermount Sink - Granite Composite
          </button>
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="isSinkSelected('sinkFarmhouseFireclay')"
            [class.text-white]="isSinkSelected('sinkFarmhouseFireclay')"
            [class.bg-white]="!isSinkSelected('sinkFarmhouseFireclay')"
            [class.text-tertiary]="!isSinkSelected('sinkFarmhouseFireclay')"
            (click)="selectSink('sinkFarmhouseFireclay')"
          >
            Farmhouse Sink - Fireclay
          </button>
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="isSinkSelected('sinkFarmhouseStainlessSteel')"
            [class.text-white]="isSinkSelected('sinkFarmhouseStainlessSteel')"
            [class.bg-white]="!isSinkSelected('sinkFarmhouseStainlessSteel')"
            [class.text-tertiary]="!isSinkSelected('sinkFarmhouseStainlessSteel')"
            (click)="selectSink('sinkFarmhouseStainlessSteel')"
          >
            Farmhouse Sink - Stainless Steel
          </button>
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="isSinkSelected('sinkFarmhouseBlanco')"
            [class.text-white]="isSinkSelected('sinkFarmhouseBlanco')"
            [class.bg-white]="!isSinkSelected('sinkFarmhouseBlanco')"
            [class.text-tertiary]="!isSinkSelected('sinkFarmhouseBlanco')"
            (click)="selectSink('sinkFarmhouseBlanco')"
          >
            Farmhouse Sink - Blanco
          </button>
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="isSinkSelected('sinkCastIronUndermount')"
            [class.text-white]="isSinkSelected('sinkCastIronUndermount')"
            [class.bg-white]="!isSinkSelected('sinkCastIronUndermount')"
            [class.text-tertiary]="!isSinkSelected('sinkCastIronUndermount')"
            (click)="selectSink('sinkCastIronUndermount')"
          >
            Cast Iron - Undermount
          </button>
          <button
            type="button"
            class="px-4 py-3 rounded-md border border-gray-300 text-tertiary font-bold transition-colors col-span-1 md:col-span-1 lg:col-span-1"
            [class.bg-active-button]="isSinkSelected('sinkBuildStructure')"
            [class.text-white]="isSinkSelected('sinkBuildStructure')"
            [class.bg-white]="!isSinkSelected('sinkBuildStructure')"
            [class.text-tertiary]="!isSinkSelected('sinkBuildStructure')"
            (click)="selectSink('sinkBuildStructure')"
          >
            Build Structure
          </button>
        </div>
      </div>

      <!-- Nueva sección de Backsplash -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Backsplash</h1>

        <div class="space-y-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Prep</label>
              <div class="flex-1 flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashPrep"
                    type="radio"
                    formControlName="backsplashPrep"
                    [value]="true"
                    (change)="saveEstimate()"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashPrep"
                    type="radio"
                    formControlName="backsplashPrep"
                    [value]="false"
                    (change)="saveEstimate()"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Tile</label>
              <div class="flex-1 flex gap-4 items-center mb-1">
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashTile"
                    type="radio"
                    formControlName="backsplashTile"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashTile"
                    type="radio"
                    formControlName="backsplashTile"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="backsplashTileQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('backsplashTile')?.value !== 'yes'"
              />
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Quartz</label>
              <div class="flex-1 flex gap-4 items-center mb-1">
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashQuartz"
                    type="radio"
                    formControlName="backsplashQuartz"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashQuartz"
                    type="radio"
                    formControlName="backsplashQuartz"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="backsplashQuartzQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('backsplashQuartz')?.value !== 'yes'"
              />
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Quartzite</label>
              <div class="flex-1 flex gap-4 items-center mb-1">
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashQuartzite"
                    type="radio"
                    formControlName="backsplashQuartzite"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashQuartzite"
                    type="radio"
                    formControlName="backsplashQuartzite"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="backsplashQuartziteQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('backsplashQuartzite')?.value !== 'yes'"
              />
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Granite</label>
              <div class="flex-1 flex gap-4 items-center mb-1">
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashGranite"
                    type="radio"
                    formControlName="backsplashGranite"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashGranite"
                    type="radio"
                    formControlName="backsplashGranite"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="backsplashGraniteQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('backsplashGranite')?.value !== 'yes'"
              />
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Marble</label>
              <div class="flex-1 flex gap-4 items-center mb-1">
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashMarble"
                    type="radio"
                    formControlName="backsplashMarble"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashMarble"
                    type="radio"
                    formControlName="backsplashMarble"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="backsplashMarbleQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('backsplashMarble')?.value !== 'yes'"
              />
            </div>
          </div>

          <div class="flex flex-col gap-4">
            <div class="flex flex-col gap-2 w-full">
              <label class="text-tertiary font-bold">Other</label>
              <div class="flex-1 flex gap-4 items-center mb-1">
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashOther"
                    type="radio"
                    formControlName="backsplashOther"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    name="backsplashOther"
                    type="radio"
                    formControlName="backsplashOther"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>

              <!-- Upload button like Photo/Video Upload -->
              <div
                class="grid grid-cols-5 gap-4"
                [class.opacity-50]="form.get('backsplashOther')?.value !== 'yes'"
              >
                <div class="col-span-1">
                  <label
                    class="w-full border border-dashed border-gray-400 rounded-lg aspect-square flex items-center justify-center overflow-hidden cursor-pointer hover:bg-gray-50 transition-colors relative"
                  >
                    <input
                      type="file"
                      accept="image/*,video/*"
                      multiple
                      class="hidden"
                      (change)="onBacksplashFileSelected($event)"
                      [disabled]="!isBacksplashOtherEnabled()"
                    />

                    <ng-container *ngIf="getBacksplashUploadPreviewUrl(); else defaultIcon">
                      <div class="w-full h-full relative">
                        <ng-container
                          *ngIf="
                            backsplashSelectedFiles[0]?.type?.startsWith('image');
                            else videoPreview
                          "
                        >
                          <img
                            [src]="getBacksplashUploadPreviewUrl()!"
                            alt="Preview"
                            class="w-full h-full object-cover"
                          />
                        </ng-container>
                        <ng-template #videoPreview>
                          <video
                            [src]="getBacksplashUploadPreviewUrl()!"
                            class="w-full h-full object-cover"
                            muted
                          ></video>
                        </ng-template>
                        <div
                          *ngIf="backsplashSelectedFiles.length > 1"
                          class="absolute right-1 top-1 bg-primary text-white text-[10px] font-bold rounded-full px-1"
                        >
                          +{{ backsplashSelectedFiles.length - 1 }}
                        </div>
                      </div>
                    </ng-container>
                    <ng-template #defaultIcon>
                      <div class="text-center">
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke-width="1.5"
                          stroke="currentColor"
                          class="w-6 h-6 text-gray-500 mx-auto mb-1"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M12 16.5V9.75m0 0L9.75 12M12 9.75l2.25 2.25M6.75 19.5h10.5A2.25 2.25 0 0019.5 17.25V6.75A2.25 2.25 0 0017.25 4.5H6.75A2.25 2.25 0 004.5 6.75v10.5A2.25 2.25 0 006.75 19.5z"
                          />
                        </svg>
                        <p class="text-xs text-gray-500">Click to upload</p>
                      </div>
                    </ng-template>
                  </label>
                </div>

                <div class="col-span-4 flex flex-col gap-2">
                  <textarea
                    #backsplashComment
                    placeholder="Enter comment for the selected files..."
                    class="w-full border border-gray-300 rounded-lg p-3 bg-white resize-none"
                    rows="3"
                    [disabled]="!isBacksplashOtherEnabled()"
                  ></textarea>
                  <button
                    type="button"
                    class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold hover:bg-gray-50 disabled:opacity-50"
                    (click)="
                      addBacksplashFilesWithComment(backsplashComment.value);
                      backsplashComment.value = ''
                    "
                    [disabled]="!isBacksplashOtherEnabled()"
                  >
                    Add Files with Comment
                  </button>
                </div>
              </div>

              <!-- Uploaded list -->
              <div class="space-y-4 mt-3" *ngIf="getBacksplashFiles().length > 0">
                <div
                  *ngFor="let f of getBacksplashFiles(); trackBy: trackByBacksplashFile"
                  class="bg-white border border-gray-300 rounded-lg p-4 flex gap-4"
                >
                  <div class="flex-shrink-0">
                    <ng-container *ngIf="f.type === 'image'; else videoItem">
                      <img [src]="f.url" [alt]="f.name" class="w-24 h-24 object-cover rounded" />
                    </ng-container>
                    <ng-template #videoItem>
                      <video
                        [src]="f.url"
                        class="w-24 h-24 object-cover rounded"
                        controls
                        muted
                      ></video>
                    </ng-template>
                  </div>
                  <div class="flex-grow flex flex-col gap-3">
                    <textarea
                      [value]="f.comment"
                      (input)="updateBacksplashFileCommentFromEvent(f.id, $event)"
                      class="w-full border border-gray-300 rounded-md p-2 bg-white resize-none"
                      rows="2"
                      placeholder="Enter comment..."
                    ></textarea>
                  </div>
                  <div class="flex-shrink-0 flex items-start">
                    <button
                      type="button"
                      class="p-2 flex items-center justify-center"
                      (click)="removeBacksplashFile(f.id)"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke-width="1.5"
                        stroke="currentColor"
                        class="w-5 h-5 text-tertiary"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"
                        />
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold"
                >Backsplash Comments (Photo/Video Upload)</label
              >
              <div class="grid grid-cols-5 gap-4 mb-6">
                <div class="col-span-1">
                  <div class="relative">
                    <input
                      type="file"
                      #backsplashCommentsFileInput
                      (change)="onBacksplashCommentsFileSelected($event)"
                      accept="image/*,video/*"
                      multiple
                      class="hidden"
                    />
                    <div
                      class="border border-dashed border-gray-400 rounded-lg bg-white aspect-square flex items-center justify-center cursor-pointer hover:bg-gray-50 transition-colors overflow-hidden"
                      (click)="backsplashCommentsFileInput.click()"
                      (keyup.enter)="backsplashCommentsFileInput.click()"
                      (keyup.space)="backsplashCommentsFileInput.click()"
                      tabindex="0"
                      role="button"
                    >
                      <div
                        *ngIf="getBacksplashCommentsUploadPreviewUrl()"
                        class="w-full h-full relative"
                      >
                        <img
                          *ngIf="
                            backsplashCommentsSelectedFiles.length > 0 &&
                            backsplashCommentsSelectedFiles[0].type.startsWith('image/')
                          "
                          [src]="getBacksplashCommentsUploadPreviewUrl()!"
                          [alt]="backsplashCommentsSelectedFiles[0].name"
                          class="w-full h-full object-cover"
                        />
                        <video
                          *ngIf="
                            backsplashCommentsSelectedFiles.length > 0 &&
                            backsplashCommentsSelectedFiles[0].type.startsWith('video/')
                          "
                          [src]="getBacksplashCommentsUploadPreviewUrl()!"
                          class="w-full h-full object-cover"
                          muted
                        ></video>
                        <div
                          *ngIf="backsplashCommentsSelectedFiles.length > 1"
                          class="absolute top-1 right-1 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded"
                        >
                          +{{ backsplashCommentsSelectedFiles.length - 1 }}
                        </div>
                      </div>
                      <div *ngIf="!getBacksplashCommentsUploadPreviewUrl()" class="text-center">
                        <svg
                          class="w-6 h-6 text-gray-400 mx-auto mb-1"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                          aria-hidden="true"
                          focusable="false"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                          />
                        </svg>
                        <p class="text-xs text-gray-500">Click to upload</p>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-span-4 flex flex-col gap-2">
                  <textarea
                    #backsplashCommentsComment
                    placeholder="Enter comment for the selected files..."
                    class="w-full border border-gray-300 rounded-lg p-3 bg-white resize-none"
                    rows="3"
                  ></textarea>
                  <button
                    type="button"
                    class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold hover:bg-gray-50"
                    (click)="
                      addBacksplashCommentsFilesWithComment(backsplashCommentsComment.value);
                      backsplashCommentsComment.value = ''
                    "
                  >
                    Add Files with Comment
                  </button>
                </div>
              </div>

              <div *ngIf="getBacksplashCommentsFiles().length > 0" class="space-y-4">
                <div
                  *ngFor="
                    let f of getBacksplashCommentsFiles();
                    trackBy: trackByBacksplashCommentsFile
                  "
                  class="bg-white border border-gray-300 rounded-lg p-4 flex gap-4"
                >
                  <div class="flex-shrink-0">
                    <img
                      *ngIf="f.type === 'image'"
                      [src]="f.url"
                      [alt]="f.name"
                      class="w-24 h-24 object-cover rounded-md"
                    />
                    <video
                      *ngIf="f.type === 'video'"
                      [src]="f.url"
                      class="w-24 h-24 object-cover rounded-md"
                      controls
                      muted
                    ></video>
                  </div>
                  <div class="flex-grow flex flex-col gap-3">
                    <div class="text-tertiary font-semibold break-all">
                      {{ f.name }}
                    </div>
                    <textarea
                      [value]="f.comment"
                      (input)="updateBacksplashCommentsFileCommentFromEvent(f.id, $event)"
                      class="w-full border border-gray-300 rounded-md p-2 bg-white resize-none"
                      rows="2"
                      placeholder="Enter comment..."
                    ></textarea>
                  </div>
                  <div class="flex-shrink-0 flex items-start">
                    <button
                      type="button"
                      class="p-2 flex items-center justify-center"
                      (click)="removeBacksplashCommentsFile(f.id)"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke-width="1.5"
                        stroke="currentColor"
                        class="w-5 h-5 text-tertiary"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"
                        />
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Stone Backsplash Template fee -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">
          Stone Backsplash Template fee
        </h1>

        <div class="grid grid-cols-3 gap-4">
          <button
            type="button"
            class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="
              this.form.get('stoneBacksplashTemplateFeeSmall')?.value === true
            "
            [class.text-white]="this.form.get('stoneBacksplashTemplateFeeSmall')?.value === true"
            [class.bg-white]="this.form.get('stoneBacksplashTemplateFeeSmall')?.value !== true"
            [class.text-tertiary]="this.form.get('stoneBacksplashTemplateFeeSmall')?.value !== true"
            [disabled]="true"
          >
            Small Kitchen
          </button>
          <button
            type="button"
            class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="
              this.form.get('stoneBacksplashTemplateFeeMedium')?.value === true
            "
            [class.text-white]="this.form.get('stoneBacksplashTemplateFeeMedium')?.value === true"
            [class.bg-white]="this.form.get('stoneBacksplashTemplateFeeMedium')?.value !== true"
            [class.text-tertiary]="
              this.form.get('stoneBacksplashTemplateFeeMedium')?.value !== true
            "
            [disabled]="true"
          >
            Medium Kitchen
          </button>
          <button
            type="button"
            class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold transition-colors"
            [class.bg-active-button]="
              this.form.get('stoneBacksplashTemplateFeeLarge')?.value === true
            "
            [class.text-white]="this.form.get('stoneBacksplashTemplateFeeLarge')?.value === true"
            [class.bg-white]="this.form.get('stoneBacksplashTemplateFeeLarge')?.value !== true"
            [class.text-tertiary]="this.form.get('stoneBacksplashTemplateFeeLarge')?.value !== true"
            [disabled]="true"
          >
            Large Kitchen
          </button>
        </div>
      </div>

      <!-- Nueva sección de Drywall -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Drywall</h1>

        <div class="space-y-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Smooth ceilings</label>
            <div class="flex gap-4 items-center mb-1">
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="drywallSmoothCeilings"
                  formControlName="drywallSmoothCeilings"
                  value="yes"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="drywallSmoothCeilings"
                  formControlName="drywallSmoothCeilings"
                  value=""
                  checked
                  class="w-4 h-4"
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">Popcorn</label>
                <div class="flex gap-4 items-center mb-1">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="drywallSmoothCeilingsPopcorn"
                      formControlName="drywallSmoothCeilingsPopcorn"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="drywallSmoothCeilingsPopcorn"
                      formControlName="drywallSmoothCeilingsPopcorn"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="drywallSmoothCeilingsPopcornQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="
                    form.get('drywallSmoothCeilingsPopcorn')?.value !== 'yes' ||
                    form.get('drywallSmoothCeilings')?.value !== 'yes'
                  "
                />
              </div>
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">Stomped</label>
                <div class="flex gap-4 items-center mb-1">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="drywallSmoothCeilingsStomped"
                      formControlName="drywallSmoothCeilingsStomped"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="drywallSmoothCeilingsStomped"
                      formControlName="drywallSmoothCeilingsStomped"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="drywallSmoothCeilingsStompedQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="
                    form.get('drywallSmoothCeilingsStomped')?.value !== 'yes' ||
                    form.get('drywallSmoothCeilings')?.value !== 'yes'
                  "
                />
              </div>
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">Orange peel</label>
                <div class="flex gap-4 items-center mb-1">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="drywallSmoothCeilingsOrangePeel"
                      formControlName="drywallSmoothCeilingsOrangePeel"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="drywallSmoothCeilingsOrangePeel"
                      formControlName="drywallSmoothCeilingsOrangePeel"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="drywallSmoothCeilingsOrangePeelQuantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="
                    form.get('drywallSmoothCeilingsOrangePeel')?.value !== 'yes' ||
                    form.get('drywallSmoothCeilings')?.value !== 'yes'
                  "
                />
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Remove wallpaper</label>
              <div class="flex gap-4 items-center mb-1">
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="drywallRemoveWallpaper"
                    formControlName="drywallRemoveWallpaper"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="drywallRemoveWallpaper"
                    formControlName="drywallRemoveWallpaper"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="drywallRemoveWallpaperQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('drywallRemoveWallpaper')?.value !== 'yes'"
              />
            </div>
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Drywall Repairs ceiling, walls</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="drywallRepairsCeilingWalls"
                    formControlName="drywallRepairsCeilingWalls"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="drywallRepairsCeilingWalls"
                    formControlName="drywallRepairsCeilingWalls"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Appliance Installation -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">
          Appliance Installation
        </h1>

        <div class="space-y-4">
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Free standing Range</label>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 w-full md:w-3/4">
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">30" Range</label>
                <div class="flex gap-4 items-center mb-1">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="applianceFreestandingRange30"
                      formControlName="applianceFreestandingRange30"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="applianceFreestandingRange30"
                      formControlName="applianceFreestandingRange30"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="applianceFreestandingRange30Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('applianceFreestandingRange30')?.value !== 'yes'"
                />
              </div>
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">36" Range</label>
                <div class="flex gap-4 items-center mb-1">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="applianceFreestandingRange36"
                      formControlName="applianceFreestandingRange36"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="applianceFreestandingRange36"
                      formControlName="applianceFreestandingRange36"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="applianceFreestandingRange36Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('applianceFreestandingRange36')?.value !== 'yes'"
                />
              </div>
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">48" Range</label>
                <div class="flex gap-4 items-center mb-1">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="applianceFreestandingRange48"
                      formControlName="applianceFreestandingRange48"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="applianceFreestandingRange48"
                      formControlName="applianceFreestandingRange48"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="applianceFreestandingRange48Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('applianceFreestandingRange48')?.value !== 'yes'"
                />
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Cooktop</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    name="applianceCooktop"
                    type="radio"
                    formControlName="applianceCooktop"
                    [value]="true"
                    (change)="saveEstimate()"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    name="applianceCooktop"
                    type="radio"
                    formControlName="applianceCooktop"
                    [value]="false"
                    (change)="saveEstimate()"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Double Oven</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    name="applianceDoubleOven"
                    type="radio"
                    formControlName="applianceDoubleOven"
                    [value]="true"
                    (change)="saveEstimate()"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    name="applianceDoubleOven"
                    type="radio"
                    formControlName="applianceDoubleOven"
                    [value]="false"
                    (change)="saveEstimate()"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
            </div>
          </div>

          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Hood insert</label>
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  name="applianceHoodInsert"
                  type="radio"
                  formControlName="applianceHoodInsert"
                  [value]="true"
                  (change)="saveEstimate()"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  name="applianceHoodInsert"
                  type="radio"
                  formControlName="applianceHoodInsert"
                  [value]="false"
                  (change)="saveEstimate()"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
          </div>

          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Microwave</label>
            <div class="flex gap-2 w-full md:w-1/2">
              <button
                type="button"
                class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold transition-colors flex-1"
                [class.bg-active-button]="
                  this.form.get('applianceMicrowave')?.value === 'above-range'
                "
                [class.text-white]="this.form.get('applianceMicrowave')?.value === 'above-range'"
                [class.bg-white]="this.form.get('applianceMicrowave')?.value !== 'above-range'"
                [class.text-tertiary]="this.form.get('applianceMicrowave')?.value !== 'above-range'"
                (click)="select('applianceMicrowave', 'above-range')"
              >
                Above range
              </button>
              <button
                type="button"
                class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold transition-colors flex-1"
                [class.bg-active-button]="this.form.get('applianceMicrowave')?.value === 'built-in'"
                [class.text-white]="this.form.get('applianceMicrowave')?.value === 'built-in'"
                [class.bg-white]="this.form.get('applianceMicrowave')?.value !== 'built-in'"
                [class.text-tertiary]="this.form.get('applianceMicrowave')?.value !== 'built-in'"
                (click)="select('applianceMicrowave', 'built-in')"
              >
                Built in
              </button>
            </div>
          </div>

          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Fridge</label>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 w-full md:w-3/4">
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">36" Fridge</label>
                <div class="flex gap-4 items-center mb-1">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="applianceFridge36"
                      formControlName="applianceFridge36"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="applianceFridge36"
                      formControlName="applianceFridge36"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="applianceFridge36Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('applianceFridge36')?.value !== 'yes'"
                />
              </div>
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">42" Fridge</label>
                <div class="flex gap-4 items-center mb-1">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="applianceFridge42"
                      formControlName="applianceFridge42"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="applianceFridge42"
                      formControlName="applianceFridge42"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="applianceFridge42Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('applianceFridge42')?.value !== 'yes'"
                />
              </div>
            </div>
          </div>

          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Beverage Fridge/Wine Fridge</label>
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  name="applianceBeverageFridge"
                  type="radio"
                  formControlName="applianceBeverageFridge"
                  [value]="true"
                  (change)="saveEstimate()"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  name="applianceBeverageFridge"
                  type="radio"
                  formControlName="applianceBeverageFridge"
                  [value]="false"
                  (change)="saveEstimate()"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
          </div>

          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Ice maker</label>
            <div class="flex gap-2 w-full md:w-1/2">
              <button
                type="button"
                class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold transition-colors flex-1"
                [class.bg-active-button]="
                  this.form.get('applianceIceMaker')?.value === 'without-drain'
                "
                [class.text-white]="this.form.get('applianceIceMaker')?.value === 'without-drain'"
                [class.bg-white]="this.form.get('applianceIceMaker')?.value !== 'without-drain'"
                [class.text-tertiary]="
                  this.form.get('applianceIceMaker')?.value !== 'without-drain'
                "
                (click)="select('applianceIceMaker', 'without-drain')"
              >
                Without drain
              </button>
              <button
                type="button"
                class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold transition-colors flex-1"
                [class.bg-active-button]="
                  this.form.get('applianceIceMaker')?.value === 'with-drain'
                "
                [class.text-white]="this.form.get('applianceIceMaker')?.value === 'with-drain'"
                [class.bg-white]="this.form.get('applianceIceMaker')?.value !== 'with-drain'"
                [class.text-tertiary]="this.form.get('applianceIceMaker')?.value !== 'with-drain'"
                (click)="select('applianceIceMaker', 'with-drain')"
              >
                With drain
              </button>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Wash and dryer</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    name="applianceWashDryer"
                    type="radio"
                    formControlName="applianceWashDryer"
                    [value]="true"
                    (change)="saveEstimate()"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    name="applianceWashDryer"
                    type="radio"
                    formControlName="applianceWashDryer"
                    [value]="false"
                    (change)="saveEstimate()"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Dishwasher</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    name="applianceDishwasher"
                    type="radio"
                    formControlName="applianceDishwasher"
                    [value]="true"
                    (change)="saveEstimate()"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    name="applianceDishwasher"
                    type="radio"
                    formControlName="applianceDishwasher"
                    [value]="false"
                    (change)="saveEstimate()"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
            </div>
          </div>

          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Disposal</label>
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  name="applianceDisposal"
                  type="radio"
                  formControlName="applianceDisposal"
                  [value]="true"
                  (change)="saveEstimate()"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  name="applianceDisposal"
                  type="radio"
                  formControlName="applianceDisposal"
                  [value]="false"
                  (change)="saveEstimate()"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Trim -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Trim</h1>

        <div class="space-y-4">
          <!-- 1/4 Round / SHOEMOLD -->
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">1/4 Round / SHOEMOLD</label>
            <input
              type="number"
              inputmode="numeric"
              pattern="[0-9]*"
              min="0"
              step="1"
              formControlName="trimQuarterRound"
              (keyup)="saveEstimate()"
              placeholder=""
              class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
            />
          </div>

          <!-- Baseboards -->
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Baseboards</label>
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="trimBaseboards"
                  formControlName="trimBaseboards"
                  value="yes"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="trimBaseboards"
                  formControlName="trimBaseboards"
                  value=""
                  checked
                  class="w-4 h-4"
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>

            <!-- Baseboards subsecciones -->
            <div class="ml-4 space-y-3" *ngIf="form.get('trimBaseboards')?.value === 'yes'">
              <!-- 3 1/2" -->
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">3 1/2" - $4.50</label>
                <div class="flex gap-4 items-center">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimBaseboards35"
                      formControlName="trimBaseboards35"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimBaseboards35"
                      formControlName="trimBaseboards35"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="trimBaseboards35Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('trimBaseboards35')?.value !== 'yes'"
                />
              </div>

              <!-- 5 1/4" -->
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">5 1/4" - $6.00</label>
                <div class="flex gap-4 items-center">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimBaseboards525"
                      formControlName="trimBaseboards525"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimBaseboards525"
                      formControlName="trimBaseboards525"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="trimBaseboards525Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('trimBaseboards525')?.value !== 'yes'"
                />
              </div>

              <!-- 7 1/4" -->
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">7 1/4" - $8.00</label>
                <div class="flex gap-4 items-center">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimBaseboards725"
                      formControlName="trimBaseboards725"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimBaseboards725"
                      formControlName="trimBaseboards725"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="trimBaseboards725Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('trimBaseboards725')?.value !== 'yes'"
                />
              </div>
            </div>
          </div>

          <!-- Crown -->
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Crown</label>
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="trimCrown"
                  formControlName="trimCrown"
                  value="yes"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="trimCrown"
                  formControlName="trimCrown"
                  value=""
                  checked
                  class="w-4 h-4"
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>

            <!-- Crown subsecciones -->
            <div class="ml-4 space-y-3" *ngIf="form.get('trimCrown')?.value === 'yes'">
              <!-- 4" -->
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">4" - $4.50</label>
                <div class="flex gap-4 items-center">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimCrown4"
                      formControlName="trimCrown4"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimCrown4"
                      formControlName="trimCrown4"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="trimCrown4Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('trimCrown4')?.value !== 'yes'"
                />
              </div>

              <!-- 6" -->
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">6" - $6.00</label>
                <div class="flex gap-4 items-center">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimCrown6"
                      formControlName="trimCrown6"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimCrown6"
                      formControlName="trimCrown6"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="trimCrown6Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('trimCrown6')?.value !== 'yes'"
                />
              </div>

              <!-- 8" -->
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">8" - $8.00</label>
                <div class="flex gap-4 items-center">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimCrown8"
                      formControlName="trimCrown8"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimCrown8"
                      formControlName="trimCrown8"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="trimCrown8Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('trimCrown8')?.value !== 'yes'"
                />
              </div>
            </div>
          </div>

          <!-- Door casing -->
          <div class="flex flex-col gap-2">
            <label class="text-tertiary font-bold">Door casing</label>
            <div class="flex gap-4 items-center">
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="trimDoorCasing"
                  formControlName="trimDoorCasing"
                  value="yes"
                  class="w-4 h-4"
                />
                <span class="text-tertiary">Yes</span>
              </label>
              <label class="flex items-center gap-2">
                <input
                  type="radio"
                  name="trimDoorCasing"
                  formControlName="trimDoorCasing"
                  value=""
                  checked
                  class="w-4 h-4"
                />
                <span class="text-tertiary">No</span>
              </label>
            </div>

            <!-- Door casing subsecciones -->
            <div class="ml-4 space-y-3" *ngIf="form.get('trimDoorCasing')?.value === 'yes'">
              <!-- 2.25" -->
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">2.25" - $3.50</label>
                <div class="flex gap-4 items-center">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimDoorCasing225"
                      formControlName="trimDoorCasing225"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimDoorCasing225"
                      formControlName="trimDoorCasing225"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="trimDoorCasing225Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('trimDoorCasing225')?.value !== 'yes'"
                />
              </div>

              <!-- 3.5" -->
              <div class="flex flex-col gap-2">
                <label class="text-tertiary font-bold">3.5" - $6.00</label>
                <div class="flex gap-4 items-center">
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimDoorCasing35"
                      formControlName="trimDoorCasing35"
                      value="yes"
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">Yes</span>
                  </label>
                  <label class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="trimDoorCasing35"
                      formControlName="trimDoorCasing35"
                      value=""
                      checked
                      class="w-4 h-4"
                    />
                    <span class="text-tertiary">No</span>
                  </label>
                </div>
                <input
                  type="number"
                  inputmode="numeric"
                  pattern="[0-9]*"
                  min="0"
                  step="1"
                  formControlName="trimDoorCasing35Quantity"
                  (keyup)="saveEstimate()"
                  placeholder="##"
                  class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                  [class.bg-gray-200]="form.get('trimDoorCasing35')?.value !== 'yes'"
                />
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Painting -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Painting</h1>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Columna izquierda -->
          <div class="space-y-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Prime (SF per coat) ceiling, walls</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintPrimeCeilingWalls"
                    formControlName="paintPrimeCeilingWalls"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintPrimeCeilingWalls"
                    formControlName="paintPrimeCeilingWalls"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="paintPrimeCeilingWallsQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('paintPrimeCeilingWalls')?.value !== 'yes'"
              />
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Trim (crown, base, casing)</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintTrimCrownBaseCasing"
                    formControlName="paintTrimCrownBaseCasing"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintTrimCrownBaseCasing"
                    formControlName="paintTrimCrownBaseCasing"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="paintTrimCrownBaseCasingQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('paintTrimCrownBaseCasing')?.value !== 'yes'"
              />
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Window paint</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintWindow"
                    formControlName="paintWindow"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintWindow"
                    formControlName="paintWindow"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="paintWindowQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('paintWindow')?.value !== 'yes'"
              />
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Exterior door stain and seal</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintExteriorDoorStainSeal"
                    formControlName="paintExteriorDoorStainSeal"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintExteriorDoorStainSeal"
                    formControlName="paintExteriorDoorStainSeal"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="paintExteriorDoorStainSealQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('paintExteriorDoorStainSeal')?.value !== 'yes'"
              />
            </div>
          </div>

          <!-- Columna derecha -->
          <div class="space-y-4">
            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Paint ceiling, walls</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintCeilingWalls"
                    formControlName="paintCeilingWalls"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintCeilingWalls"
                    formControlName="paintCeilingWalls"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="paintCeilingWallsQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('paintCeilingWalls')?.value !== 'yes'"
              />
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Door paint</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintDoor"
                    formControlName="paintDoor"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintDoor"
                    formControlName="paintDoor"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="paintDoorQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('paintDoor')?.value !== 'yes'"
              />
            </div>

            <div class="flex flex-col gap-2">
              <label class="text-tertiary font-bold">Exterior door paint</label>
              <div class="flex gap-4 items-center">
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintExteriorDoor"
                    formControlName="paintExteriorDoor"
                    value="yes"
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">Yes</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="radio"
                    name="paintExteriorDoor"
                    formControlName="paintExteriorDoor"
                    value=""
                    checked
                    class="w-4 h-4"
                  />
                  <span class="text-tertiary">No</span>
                </label>
              </div>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="paintExteriorDoorQuantity"
                (keyup)="saveEstimate()"
                placeholder="##"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                [class.bg-gray-200]="form.get('paintExteriorDoor')?.value !== 'yes'"
              />
            </div>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Voice Recording Notes -->
      <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
        <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">
          Voice Recording Notes
        </h1>

        <!-- Panel de Control de Grabación -->
        <div class="p-4">
          <!-- Botón Principal de Grabación y Controles -->
          <div class="flex items-center gap-4 mb-4">
            <!-- Botón Principal de Grabación -->
            <div class="w-1/2">
              <!-- [disabled]="!isVoiceSupported()" -->
              <button
                type="button"
                class="w-full flex items-center justify-center gap-3 px-6 py-3 bg-green-600 text-white rounded-lg font-bold transition-colors hover:bg-green-700"
                [class.bg-red-600]="isRecording()"
                [class.hover:bg-red-700]="isRecording()"
                (click)="toggleVoiceRecording()"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  class="w-5 h-5"
                >
                  <path
                    d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"
                  />
                  <path
                    d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"
                  />
                </svg>
                <div class="flex flex-col items-center text-center">
                  <span class="text-base font-bold">Voice recording</span>
                  <span class="text-xs">Project Summary</span>
                </div>
              </button>
            </div>

            <!-- Controles de Reproducción -->
            <div class="w-1/2 flex flex-col gap-2">
              <div class="flex gap-2">
                <button
                  type="button"
                  class="w-10 h-10 bg-green-600 text-white rounded-lg flex items-center justify-center hover:bg-green-700 transition-colors"
                  [disabled]="!hasRecording()"
                  (click)="playRecording()"
                  title="Play recording"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                    class="w-4 h-4"
                  >
                    <path d="M8 5v14l11-7z" />
                  </svg>
                </button>

                <button
                  type="button"
                  class="w-10 h-10 bg-gray-300 text-gray-700 rounded-lg flex items-center justify-center hover:bg-gray-400 transition-colors"
                  [disabled]="!hasRecording()"
                  (click)="togglePlaybackSpeed()"
                  title="Change playback speed"
                >
                  x {{ playbackSpeed() }}
                </button>

                <button
                  type="button"
                  class="w-10 h-10 bg-red-600 text-white rounded-lg flex items-center justify-center hover:bg-red-700 transition-colors"
                  [disabled]="!hasRecording()"
                  (click)="deleteRecording()"
                  title="Delete recording"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                    class="w-4 h-4"
                  >
                    <path
                      d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"
                    />
                  </svg>
                </button>
              </div>

              <!-- Barra de Progreso -->
              <div class="w-full bg-gray-300 rounded-full h-2">
                <div
                  class="bg-green-600 h-2 rounded-full transition-all duration-300"
                  [style.width.%]="recordingProgress()"
                ></div>
              </div>
              <div class="text-xs text-gray-600 mt-1 text-right">
                {{ recordingProgress() | number : '1.0-0' }}%
              </div>
            </div>
          </div>
        </div>

        <!-- Sección de Resumen de la Grabación -->
        <div class="bg-white rounded-lg p-4 border border-gray-300">
          <h2 class="text-tertiary font-bold text-lg mb-4">Voice Recording Summary</h2>

          <!-- Área de contenido del resumen -->
          <div class="min-h-[200px] p-4">
            <!-- Estado sin grabación -->
            <div *ngIf="!hasRecording()" class="flex items-center justify-center h-full">
              <p class="text-gray-500 italic text-center">
                No recording available. Click on the recording button to start.
              </p>
            </div>

            <!-- Estado con grabación disponible -->
            <div *ngIf="hasRecording() && !isTranscribing()" class="space-y-4">
              <!-- Información de la grabación -->
              <div class="flex gap-4 text-gray-600 mb-4">
                <span><strong>Duration:</strong> {{ formatDuration(recordingDuration()) }}</span>
                <span><strong>File size:</strong> {{ formatFileSize(recordingSize()) }}</span>
              </div>

              <!-- Transcripción/Resumen -->
              <div *ngIf="transcriptionText()" class="bg-white p-4 rounded border">
                <h3 class="text-tertiary font-semibold mb-2">Transcription:</h3>
                <div class="text-gray-700 leading-relaxed whitespace-pre-wrap">
                  {{ transcriptionText() }}
                </div>
              </div>

              <!-- Resumen procesado -->
              <div *ngIf="summaryText()" class="bg-blue-50 p-4 rounded border border-blue-200">
                <h3 class="text-tertiary font-semibold mb-2">Project Summary:</h3>
                <div class="text-gray-700 leading-relaxed whitespace-pre-wrap">
                  {{ summaryText() }}
                </div>
              </div>
            </div>

            <!-- Estado cargando/transcribiendo (único loader y mensaje) -->
            <div
              *ngIf="isTranscribing() || isLoading()"
              class="flex flex-col items-center justify-center h-full space-y-4"
            >
              <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
              <p class="text-gray-600">
                {{ isTranscribing() ? 'Transcribing recording...' : 'Processing audio...' }}
              </p>
            </div>
          </div>
        </div>

        <!-- Nueva sección de Media (Fotos, Videos y Comentarios) -->
        <div class="flex flex-col gap-4 bg-gray-100 rounded-xl p-4 py-6 border border-gray-300">
          <h1 class="text-tertiary font-bold font-merriweather text-xl mb-2">Media</h1>

          <div class="grid grid-cols-5 gap-4 mb-6">
            <div class="col-span-1">
              <div class="relative">
                <input
                  type="file"
                  #mediaFileInput
                  (change)="onMediaFileSelected($event)"
                  accept="image/*,video/*"
                  multiple
                  class="hidden"
                />
                <div
                  class="border border-dashed border-gray-400 rounded-lg bg-white aspect-square flex items-center justify-center cursor-pointer hover:bg-gray-50 transition-colors overflow-hidden"
                  (click)="mediaFileInput.click()"
                  (keyup.enter)="mediaFileInput.click()"
                  (keyup.space)="mediaFileInput.click()"
                  tabindex="0"
                  role="button"
                >
                  <div *ngIf="getMediaUploadPreviewUrl()" class="w-full h-full relative">
                    <img
                      *ngIf="
                        mediaSelectedFiles.length > 0 &&
                        mediaSelectedFiles[0].type.startsWith('image/')
                      "
                      [src]="getMediaUploadPreviewUrl()!"
                      [alt]="mediaSelectedFiles[0].name"
                      class="w-full h-full object-cover"
                    />
                    <video
                      *ngIf="
                        mediaSelectedFiles.length > 0 &&
                        mediaSelectedFiles[0].type.startsWith('video/')
                      "
                      [src]="getMediaUploadPreviewUrl()!"
                      class="w-full h-full object-cover"
                      muted
                    ></video>
                    <div
                      *ngIf="mediaSelectedFiles.length > 1"
                      class="absolute top-1 right-1 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded"
                    >
                      +{{ mediaSelectedFiles.length - 1 }}
                    </div>
                  </div>
                  <div *ngIf="!getMediaUploadPreviewUrl()" class="text-center">
                    <svg
                      class="w-6 h-6 text-gray-400 mx-auto mb-1"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                      aria-hidden="true"
                      focusable="false"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                      />
                    </svg>
                    <p class="text-xs text-gray-500">Click to upload</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-span-4 flex flex-col gap-2">
              <textarea
                #mediaComment
                placeholder="Enter comment for the selected files..."
                class="w-full border border-gray-300 rounded-lg p-3 bg-white resize-none"
                rows="3"
              ></textarea>
              <button
                type="button"
                class="px-4 py-2 rounded-md border border-gray-300 text-tertiary font-bold hover:bg-gray-50"
                (click)="addMediaFilesWithComment(mediaComment.value); mediaComment.value = ''"
              >
                Add Files with Comment
              </button>
            </div>
          </div>

          <div *ngIf="getMediaFiles().length > 0" class="space-y-4">
            <div
              *ngFor="let f of getMediaFiles(); trackBy: trackByMediaFile"
              class="bg-white border border-gray-300 rounded-lg p-4 flex gap-4"
            >
              <div class="flex-shrink-0">
                <img
                  *ngIf="f.type === 'image'"
                  [src]="f.url"
                  [alt]="f.name"
                  class="w-24 h-24 object-cover rounded-md"
                />
                <video
                  *ngIf="f.type === 'video'"
                  [src]="f.url"
                  class="w-24 h-24 object-cover rounded-md"
                  controls
                  muted
                ></video>
              </div>
              <div class="flex-grow flex flex-col gap-3">
                <div class="text-tertiary font-semibold break-all">
                  {{ f.name }}
                </div>
                <textarea
                  [value]="f.comment"
                  (input)="updateMediaFileCommentFromEvent(f.id, $event)"
                  class="w-full border border-gray-300 rounded-md p-2 bg-white resize-none"
                  rows="2"
                  placeholder="Enter comment..."
                ></textarea>
              </div>
              <div class="flex-shrink-0 flex items-start">
                <button
                  type="button"
                  class="p-2 flex items-center justify-center"
                  (click)="removeMediaFile(f.id)"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5 text-tertiary"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"
                    />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Notes y Files -->
      <div
        class="flex flex-col gap-4 bg-gray2 rounded-xl p-4 py-6 border border-gray1 notes-files-section new-section"
      >
        <!-- Sección de Notas -->
        <h2 class="text-tertiary font-bold text-lg mb-4">Write or add your notes here</h2>

        <!-- Botón Advanced Drawing Tool -->
        <div class="flex flex-col gap-3">
          <button
            type="button"
            class="w-full bg-green-600 text-white rounded-lg py-4 px-6 flex items-center justify-center gap-3 hover:bg-blue-700 transition-colors"
            (click)="toggleAdvancedDrawing()"
            title="Abrir herramienta de dibujo avanzada con Paper.js"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-6 w-6 text-white"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z"
              />
            </svg>
            <span class="text-white font-bold text-lg"> Drawing Tool </span>
          </button>
        </div>

        <!-- Sección de Archivos -->
        <div class="mt-6">
          <h3 class="text-lg font-semibold text-gray-700 mb-4">Drawings</h3>

          <!-- Lista de múltiples dibujos -->
          <div class="space-y-4" *ngIf="getMultipleDrawings().length > 0">
            <div
              *ngFor="let drawing of getMultipleDrawings(); trackBy: trackByDrawing"
              class="bg-white border border-gray-300 rounded-lg p-4 flex gap-4"
            >
              <div class="flex-shrink-0">
                <img
                  [src]="drawing.url || drawing.data"
                  [alt]="drawing.name"
                  class="w-24 h-24 object-cover rounded-md"
                />
              </div>
              <div class="flex-grow flex flex-col gap-3">
                <div class="text-tertiary font-semibold">
                  {{ drawing.name }}
                </div>
                <div class="text-xs text-gray-500">
                  {{ drawing.timestamp | date : 'short' }}
                </div>
                <div class="flex gap-2">
                  <button
                    type="button"
                    class="text-blue-600 hover:underline"
                    (click)="viewDrawing(drawing)"
                  >
                    View
                  </button>
                  <a
                    *ngIf="drawing.url"
                    [href]="drawing.url"
                    target="_blank"
                    rel="noopener"
                    class="text-green-600 hover:underline"
                  >
                    Open
                  </a>
                  <button
                    type="button"
                    class="text-red-600 hover:underline"
                    (click)="removeDrawingFromMultiple(drawing.id)"
                  >
                    Remove
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Mensaje cuando no hay dibujos -->
          <div *ngIf="getMultipleDrawings().length === 0" class="text-center py-8 text-gray-500">
            <svg
              class="w-12 h-12 text-gray-300 mx-auto mb-2"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"
              />
            </svg>
            <p>No drawings yet. Click "Draw here" to create your first drawing.</p>
          </div>
        </div>
      </div>

      <!-- Nueva sección de Final Step -->
      <div
        class="bg-secondary flex flex-col gap-4 rounded-xl p-6 border border-gray-300 final-step-section"
      >
        <h1 class="text-white font-bold text-xl mb-4">Final Step</h1>

        <div class="flex flex-col gap-4">
          <!-- Time Frame for Completion -->
          <div class="flex flex-col gap-2">
            <label class="text-white font-bold"> Time Frame for Completion </label>
            <input
              type="number"
              inputmode="numeric"
              pattern="[0-9]*"
              min="0"
              step="1"
              formControlName="timeFrame"
              class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
              placeholder="Enter time frame for completion in days"
            />
          </div>

          <!-- Customer Budget y Rough Quote en la misma fila -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Customer Budget -->
            <div class="flex flex-col gap-2">
              <label class="text-white font-bold"> Customer Budget </label>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="customerBudget"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                placeholder="Enter Customer Budget"
              />
            </div>

            <!-- Rough Quote -->
            <div class="flex flex-col gap-2">
              <label class="text-white font-bold"> Rough Quote </label>
              <input
                type="number"
                inputmode="numeric"
                pattern="[0-9]*"
                min="0"
                step="1"
                formControlName="roughQuote"
                class="w-full border border-gray-300 rounded-md py-3 px-3 bg-white"
                placeholder="Enter Rough Quote"
              />
            </div>
          </div>

          <!-- Disclaimer -->
          <div class="mt-4">
            <p class="text-white">Review all entered data before submitting.*</p>
          </div>

          <!-- Result Display from clickToview -->
          <div class="result-display-section">
            <h3 class="text-lg font-semibold text-white mb-3">Estimate Result</h3>
            <button
              type="button"
              class="w-full bg-green-600 text-white rounded-md py-3 px-4 font-bold hover:bg-green-700 transition-colors"
              (click)="clickToview()"
              title="Click to view rough quote"
            >
              Click to view
            </button>
            <div
              class="result-content bg-white border border-gray-200 rounded-lg p-4 min-h-[100px] flex items-center justify-center mt-5"
              *ngIf="showEstimate() && estimateResult(); else hiddenBlock"
            >
              <div class="text-center w-full text-3xl font-bold">
                {{ estimateResult() }}
              </div>
            </div>
            <ng-template #hiddenBlock></ng-template>
          </div>
        </div>
      </div>

      <!-- Botón de Save Version -->
      <div class="flex justify-center mt-8 submit-button-container w-full">
        <button
          type="submit"
          class="w-full text-white px-8 py-4 rounded-lg font-bold text-lg transition-colors duration-200 shadow-lg save-version-btn active-button"
          (click)="onSubmit()"
        >
          Submit
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Dibujo Avanzado -->
<div
  class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"
  *ngIf="showAdvancedDrawing()"
  (click)="onAdvancedDrawingCancelled()"
  (keyup.enter)="onAdvancedDrawingCancelled()"
  (keyup.escape)="onAdvancedDrawingCancelled()"
  tabindex="0"
  role="button"
>
  <div
    class="w-full h-full bg-white flex flex-col"
    (click)="$event.stopPropagation()"
    (keyup.enter)="$event.stopPropagation()"
    (keyup.space)="$event.stopPropagation()"
    tabindex="0"
    role="button"
  >
    <!-- Header del Modal -->
    <div class="flex items-center justify-between p-4 bg-gray-50 border-b border-gray-200">
      <h2 class="text-xl font-semibold text-gray-800">Advanced Drawing Tool</h2>
      <button
        type="button"
        class="p-2 rounded-full hover:bg-gray-200 transition-colors"
        (click)="onAdvancedDrawingCancelled()"
      >
        <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </button>
    </div>

    <!-- Controles de Dibujo -->
    <div class="flex-shrink-0 p-4 bg-white border-b border-gray-200">
      <app-drawing-controls></app-drawing-controls>
    </div>

    <!-- Área de Dibujo -->
    <div class="flex-1 relative bg-gray-100">
      <app-drawing-canvas #drawingCanvas (drawingDataChanged)="onDrawingDataChanged($event)">
      </app-drawing-canvas>
    </div>

    <!-- Footer con Acciones -->
    <div class="flex-shrink-0 p-4 bg-gray-50 border-t border-gray-200">
      <div class="flex gap-3 justify-between">
        <button
          type="button"
          class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium"
          (click)="onAdvancedDrawingCancelled()"
        >
          Cancel
        </button>
        <div class="flex gap-3">
          <button
            type="button"
            class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center gap-2"
            (click)="finishAdvancedDrawing()"
          >
            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M5 13l4 4L19 7"
              ></path>
            </svg>
            Finish
          </button>
          <button
            type="button"
            class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium"
            (click)="onAdvancedDrawingSaved(advancedDrawingData())"
          >
            Save Drawing
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal para visualizar dibujo -->
<div
  *ngIf="showDrawingViewer()"
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
  (click)="closeDrawingViewer()"
  (keyup.enter)="closeDrawingViewer()"
  (keyup.escape)="closeDrawingViewer()"
  tabindex="0"
  role="button"
>
  <div
    class="bg-white rounded-lg max-w-4xl max-h-[90vh] w-full mx-4 overflow-hidden"
    (click)="$event.stopPropagation()"
    (keyup.enter)="$event.stopPropagation()"
    (keyup.space)="$event.stopPropagation()"
    tabindex="0"
    role="button"
  >
    <!-- Header del modal -->
    <div class="flex items-center justify-between p-4 border-b border-gray-200">
      <h3 class="text-lg font-semibold text-gray-900">
        {{ selectedDrawing()?.name || 'Drawing' }}
      </h3>
      <button
        type="button"
        class="text-gray-400 hover:text-gray-600 transition-colors"
        (click)="closeDrawingViewer()"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </button>
    </div>

    <!-- Contenido del modal -->
    <div class="p-4 overflow-auto max-h-[calc(90vh-80px)]">
      <div class="flex justify-center">
        <img
          [src]="selectedDrawing()?.url || selectedDrawing()?.data"
          [alt]="selectedDrawing()?.name"
          class="max-w-full max-h-[70vh] object-contain rounded-lg shadow-lg"
        />
      </div>
    </div>

    <!-- Footer del modal -->
    <div class="flex items-center justify-between p-4 border-t border-gray-200 bg-gray-50">
      <div class="text-gray-500">
        <span *ngIf="selectedDrawing()?.timestamp">
          Created: {{ selectedDrawing()?.timestamp | date : 'medium' }}
        </span>
      </div>
      <div class="flex gap-2">
        <a
          *ngIf="selectedDrawing()?.url"
          [href]="selectedDrawing()?.url"
          target="_blank"
          rel="noopener"
          class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
        >
          Open Original
        </a>
        <button
          type="button"
          class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
          (click)="closeDrawingViewer()"
        >
          Close
        </button>
      </div>
    </div>
  </div>
</div>
