# Contexto General de la Plataforma BA

## Descripci√≥n General

BA es una plataforma digital dise√±ada para gestionar el proceso completo de estimaciones, cotizaciones y seguimiento de proyectos de construcci√≥n y remodelaci√≥n para el grupo de empresas **BA** (Business Applications). La plataforma est√° especializada en tres tipos principales de proyectos:

- **Cocinas**: Remodelaciones y construcciones de cocinas completas
- **Ba√±os**: Remodelaciones y construcciones de ba√±os
- **Otros**: Proyectos diversos de construcci√≥n y remodelaci√≥n

La plataforma facilita la comunicaci√≥n y gesti√≥n entre clientes, estimadores y administradores, proporcionando herramientas para crear cotizaciones detalladas, hacer seguimiento de proyectos y gestionar pagos.

**Caracter√≠stica Principal**: La plataforma gestiona m√∫ltiples compa√±√≠as de forma independiente, permitiendo que cada usuario seleccione la compa√±√≠a con la que trabajar√° despu√©s de iniciar sesi√≥n. Todos los proyectos, cotizaciones y datos est√°n organizados por compa√±√≠a, garantizando la separaci√≥n y organizaci√≥n de la informaci√≥n.

---

## Objetivos de la Plataforma

1. **Digitalizar el proceso de cotizaci√≥n**: Transformar el proceso tradicional de estimaciones en un flujo digital eficiente y estructurado.

2. **Mejorar la comunicaci√≥n**: Facilitar la comunicaci√≥n entre clientes y estimadores, manteniendo un registro centralizado de todas las interacciones.

3. **Transparencia en el seguimiento**: Permitir a los clientes hacer seguimiento en tiempo real del estado de sus proyectos.

4. **Gesti√≥n de pagos**: Facilitar el registro y seguimiento de pagos completos y parciales por proyecto.

5. **An√°lisis y KPIs**: Proporcionar a los administradores m√©tricas y an√°lisis para la toma de decisiones estrat√©gicas.

6. **Gesti√≥n de usuarios**: Centralizar la administraci√≥n de usuarios, roles y permisos en la plataforma.

---

## Compa√±√≠as del Grupo BA

La plataforma gestiona tres compa√±√≠as independientes dentro del grupo BA, cada una con su propio conjunto de proyectos, cotizaciones y datos:

### 1. BA Kitchen & Bath Design

Especializada en dise√±o, construcci√≥n y remodelaci√≥n de cocinas y ba√±os. Esta compa√±√≠a se enfoca en proyectos completos de dise√±o e instalaci√≥n de espacios residenciales y comerciales.

**Servicios principales**:

- Dise√±o de cocinas y ba√±os
- Remodelaciones completas
- Instalaci√≥n de gabinetes y accesorios
- Trabajos de plomer√≠a y electricidad
- Acabados y pintura

### 2. BA Stones Surfaces

Especializada en superficies de piedra natural y sint√©tica, incluyendo encimeras, backsplashes y acabados en piedra.

**Servicios principales**:

- Instalaci√≥n de encimeras de cuarzo, granito y m√°rmol
- Backsplashes en piedra
- Superficies de piedra para ba√±os
- Acabados y pulidos especializados

### 3. BA Stones Surfaces

_Nota: Esta compa√±√≠a aparece duplicada en la lista. Se recomienda verificar si corresponde a una tercera compa√±√≠a diferente o si es una variaci√≥n de BA Stones Surfaces._

---

## Sistema de Compa√±√≠as y Contexto de Trabajo

### Selecci√≥n de Compa√±√≠a

Despu√©s de iniciar sesi√≥n, todos los usuarios (clientes, estimadores y administradores) deben **seleccionar una compa√±√≠a** con la que trabajar√°n durante su sesi√≥n. Esta selecci√≥n determina el contexto de todas las operaciones posteriores.

### Independencia de Datos por Compa√±√≠a

**Caracter√≠sticas clave**:

1. **Aislamiento de Datos**: Cada compa√±√≠a mantiene sus datos completamente separados:

   - Proyectos y estimaciones son independientes por compa√±√≠a
   - Clientes pueden tener proyectos en diferentes compa√±√≠as
   - Cotizaciones est√°n asociadas a una compa√±√≠a espec√≠fica
   - Reportes y estad√≠sticas se generan por compa√±√≠a

2. **Contexto de Sesi√≥n**: Una vez seleccionada una compa√±√≠a:

   - Todas las cotizaciones creadas pertenecen a esa compa√±√≠a
   - Todos los proyectos visibles son de esa compa√±√≠a
   - Los filtros y b√∫squedas se aplican dentro del contexto de la compa√±√≠a seleccionada
   - Los KPIs y m√©tricas mostradas corresponden a esa compa√±√≠a

3. **Cambio de Compa√±√≠a**: Los usuarios pueden cambiar de compa√±√≠a en cualquier momento:
   - Al cambiar de compa√±√≠a, el contexto se actualiza inmediatamente
   - Los datos mostrados cambian seg√∫n la compa√±√≠a seleccionada
   - Se mantiene la sesi√≥n del usuario, solo cambia el contexto de trabajo

### Flujo de Trabajo con Compa√±√≠as

1. **Usuario inicia sesi√≥n** ‚Üí Autenticaci√≥n exitosa
2. **Selecci√≥n de compa√±√≠a** ‚Üí El usuario elige con qu√© compa√±√≠a trabajar
3. **Contexto activo** ‚Üí Todas las operaciones se realizan en el contexto de la compa√±√≠a seleccionada
4. **Creaci√≥n de cotizaciones** ‚Üí Autom√°ticamente asociadas a la compa√±√≠a activa
5. **Visualizaci√≥n de datos** ‚Üí Solo se muestran datos de la compa√±√≠a seleccionada
6. **Cambio de contexto** ‚Üí El usuario puede cambiar de compa√±√≠a cuando lo necesite

---

## Tipos de Proyectos

### Cocinas

Proyectos de remodelaci√≥n y construcci√≥n de cocinas que incluyen:

- Instalaci√≥n de gabinetes y alacenas
- Instalaci√≥n de electrodom√©sticos
- Trabajos de plomer√≠a y electricidad
- Instalaci√≥n de encimeras y backsplashes
- Trabajos de pintura y acabados
- Demolici√≥n y preparaci√≥n del espacio

### Ba√±os

Proyectos de remodelaci√≥n y construcci√≥n de ba√±os que incluyen:

- Instalaci√≥n de sanitarios y accesorios
- Trabajos de plomer√≠a y electricidad
- Instalaci√≥n de azulejos y acabados
- Trabajos de pintura
- Demolici√≥n y preparaci√≥n del espacio

### Otros

Proyectos diversos de construcci√≥n y remodelaci√≥n que no se clasifican en las categor√≠as anteriores.

---

## Perfiles de Usuario

La plataforma cuenta con tres perfiles principales, cada uno con funcionalidades y permisos espec√≠ficos:

### üë§ Customer (Cliente)

El perfil **customer** representa a los clientes que contratan los servicios de BA. Este perfil se crea autom√°ticamente cuando un usuario se registra en la plataforma.

#### Funcionalidades Principales:

1. **Seguimiento de Proyectos**

   - Visualizar el estado actual de sus proyectos
   - Ver el progreso y actualizaciones en tiempo real
   - Acceder al historial completo de cada proyecto

2. **Gesti√≥n de Cotizaciones**

   - Ver todas sus cotizaciones asociadas
   - Consultar detalles completos de cada estimaci√≥n
   - **Ver todas las versiones de cada estimaci√≥n**: Acceder al historial completo de versiones de cada propuesta
   - Comparar diferentes versiones de una misma estimaci√≥n
   - Comparar diferentes cotizaciones
   - Aprobar o rechazar cotizaciones
   - Solicitar cambios adicionales que generan nuevas versiones

3. **Gesti√≥n de Pagos**

   - Realizar pagos completos de proyectos
   - Realizar pagos parciales seg√∫n acuerdos
   - Ver historial de pagos realizados
   - Consultar saldos pendientes
   - Descargar comprobantes de pago

4. **Comunicaci√≥n**
   - Comunicarse con su estimador asignado
   - Recibir notificaciones sobre actualizaciones de proyectos
   - Solicitar modificaciones o aclaraciones

#### Caracter√≠sticas T√©cnicas:

- Se crea autom√°ticamente un role "customer" al registrarse
- Tiene acceso solo a sus propios proyectos y cotizaciones
- Puede ver informaci√≥n relacionada exclusivamente con su cuenta

---

### üìê Estimator (Estimador)

El perfil **estimator** representa a los profesionales que crean las cotizaciones y estimaciones para los clientes.

#### Funcionalidades Principales:

1. **Creaci√≥n de Proyectos**

   - Crear proyectos con informaci√≥n b√°sica (nombre, cliente, compa√±√≠a)
   - Asignar estimador responsable del proyecto
   - Establecer estado inicial del proyecto

2. **Creaci√≥n de Cotizaciones/Estimaciones**

   La creaci√≥n de estimaciones se realiza mediante una interfaz con **dos pesta√±as** que permiten organizar y completar toda la informaci√≥n necesaria:

   **Pesta√±a 1: Formulario Principal de Estimaci√≥n**

   - Crear estimaciones detalladas para proyectos existentes
   - Incluir informaci√≥n completa del cliente y la compa√±√≠a
   - Especificar detalles t√©cnicos del proyecto (dimensiones, materiales, etc.)
   - Calcular costos totales y parciales
   - Agregar informaci√≥n de experiencia y contexto del proyecto
   - **Asociar estimaci√≥n al proyecto**: Cada estimaci√≥n debe estar vinculada a un proyecto
   - Este formulario mantiene toda la funcionalidad existente sin modificaciones

   **Pesta√±a 2: Gesti√≥n de Materiales**

   Nueva pesta√±a dedicada exclusivamente a la gesti√≥n de la lista de materiales de la estimaci√≥n. Los estimadores pueden ingresar los materiales de **dos formas diferentes**:

   - **Subir archivo de imagen**:

     - Permite subir una imagen (JPG, PNG, PDF, etc.) que contenga la lista de materiales
     - El archivo se almacena en S3 y se guarda la URL en el campo `materials.file`
     - Ideal para cuando la lista de materiales ya existe en formato f√≠sico o digital
     - Soporta formatos de imagen y PDF

   - **Ingreso manual de materiales**:
     - Permite agregar cada material individualmente con sus detalles
     - Para cada material se especifica:
       - **Cantidad**: N√∫mero de unidades del material
       - **Descripci√≥n**: Descripci√≥n detallada del material
     - Los materiales se guardan en el campo `materials.items` como un array de objetos
     - Permite agregar, editar y eliminar materiales de la lista
     - Ideal para crear listas estructuradas y detalladas desde cero

   **Estructura del campo `materials`**: El campo `materials` es un objeto opcional que puede contener:

   - **`file` (string, opcional)**: URL del archivo subido con la lista de materiales
   - **`items` (array, opcional)**: Array de objetos con `quantity` (n√∫mero) y `description` (string) para cada material ingresado manualmente

   **Nota**: Puedes usar `file`, `items`, o ambos simult√°neamente seg√∫n tus necesidades. Esto permite flexibilidad para combinar una lista de materiales en archivo con materiales adicionales ingresados manualmente.

3. **Gesti√≥n de Cotizaciones**

   - Crear nuevas estimaciones para proyectos existentes
   - **Editar y crear nuevas versiones**: Cada vez que se edita una estimaci√≥n, se crea autom√°ticamente una nueva versi√≥n, manteniendo el historial completo
   - Ver historial de versiones de cada cotizaci√≥n
   - Comparar versiones anteriores con la actual
   - Duplicar cotizaciones para proyectos similares
   - Organizar cotizaciones por proyecto, cliente, categor√≠a o estado
   - Generar reportes de cotizaciones

4. **Seguimiento de Proyectos**

   - Reportar el progreso de los proyectos asignados
   - Actualizar el estado de cada proyecto
   - Registrar hitos y eventos importantes
   - Subir fotos y documentaci√≥n del avance

5. **Gesti√≥n de Clientes**
   - Ver informaci√≥n de clientes asignados
   - Acceder al historial de proyectos por cliente
   - Comunicarse directamente con clientes

#### Caracter√≠sticas T√©cnicas:

- Debe crear primero el proyecto antes de crear estimaciones
- Cada cotizaci√≥n debe incluir el `userId` del estimador que la crea
- Cada cotizaci√≥n debe estar asociada a un proyecto mediante `projectId`
- Puede crear m√∫ltiples estimaciones para un mismo proyecto
- Tiene acceso a informaci√≥n de clientes y proyectos asignados
- Puede subir archivos multimedia (fotos, videos, audio) relacionados con proyectos

#### Tipos de Cotizaciones:

- **Kitchen Quotes**: Cotizaciones detalladas para proyectos de cocina con m√°s de 400 campos opcionales que incluyen:
  - Dimensiones y medidas del espacio
  - Materiales y acabados
  - Electrodom√©sticos y accesorios
  - Trabajos de plomer√≠a y electricidad
  - Trabajos de pintura y acabados
  - Y muchos m√°s detalles espec√≠ficos

---

### üë®‚Äçüíº Administrador

El perfil **administrador** tiene acceso completo a la plataforma y puede gestionar todos los aspectos del sistema.

#### Funcionalidades Principales:

1. **Dashboard y KPIs**

   - Visualizar m√©tricas clave de la plataforma
   - **Filtrado por compa√±√≠a**: Ver KPIs espec√≠ficos de cada compa√±√≠a o consolidados
   - Ver estad√≠sticas de proyectos por estado
   - Analizar rendimiento de estimadores
   - Monitorear ingresos y pagos
   - Generar reportes ejecutivos
   - KPIs relevantes incluyen:
     - **KPIs por compa√±√≠a**:
       - Total de proyectos activos por compa√±√≠a
       - Proyectos por categor√≠a (Cocinas, Ba√±os, Otros) por compa√±√≠a
       - Tasa de conversi√≥n de cotizaciones por compa√±√≠a
       - Ingresos totales y pendientes por compa√±√≠a
       - Rendimiento por estimador por compa√±√≠a
       - Tiempo promedio de proyectos por compa√±√≠a
     - **KPIs consolidados**:
       - Total de proyectos activos (todas las compa√±√≠as)
       - Proyectos por categor√≠a (consolidado)
       - Tasa de conversi√≥n global
       - Ingresos totales consolidados
       - Comparativa entre compa√±√≠as

2. **Gesti√≥n de Proyectos**

   - Ver todos los proyectos de todos los clientes
   - **Filtrar por compa√±√≠a**: Ver proyectos de una compa√±√≠a espec√≠fica o todas las compa√±√≠as
   - Filtrar proyectos por estimador, cliente, categor√≠a o estado
   - Filtrar proyectos por compa√±√≠a y otros criterios combinados
   - Acceder a detalles completos de cualquier proyecto
   - Modificar estados y asignaciones de proyectos
   - Generar reportes consolidados o por compa√±√≠a

3. **Gesti√≥n de Usuarios**

   - Crear, editar y eliminar usuarios
   - Asignar y modificar roles (customer, estimator, administrador)
   - Gestionar permisos y accesos
   - Ver historial de actividad de usuarios
   - Activar/desactivar cuentas

4. **Gesti√≥n de Cotizaciones**

   - Ver todas las cotizaciones del sistema
   - **Filtrar por compa√±√≠a**: Ver cotizaciones de una compa√±√≠a espec√≠fica o todas
   - Filtrar por estimador, cliente, categor√≠a o rango de fechas
   - Filtrar por compa√±√≠a combinado con otros criterios
   - Analizar tendencias de cotizaciones por compa√±√≠a
   - Comparar rendimiento de cotizaciones entre compa√±√≠as
   - Exportar datos para an√°lisis externos (por compa√±√≠a o consolidado)

5. **Gesti√≥n de Pagos**

   - Ver todos los pagos realizados por todos los clientes
   - **Filtrar por compa√±√≠a**: Ver pagos de una compa√±√≠a espec√≠fica o todas
   - Generar reportes de pagos por compa√±√≠a o consolidados
   - Filtrar pagos por cliente, proyecto, rango de fechas
   - Filtrar pagos por compa√±√≠a combinado con otros criterios
   - Exportar informaci√≥n financiera por compa√±√≠a
   - Reconciliar pagos y proyectos por compa√±√≠a
   - Comparar ingresos entre compa√±√≠as

6. **Administraci√≥n del Sistema**
   - Configurar par√°metros generales de la plataforma
   - **Gestionar compa√±√≠as**: Crear, editar y configurar compa√±√≠as del sistema
   - Gestionar categor√≠as de proyectos
   - Administrar plantillas de cotizaciones (por compa√±√≠a o globales)
   - Configurar notificaciones y alertas
   - Asignar usuarios a compa√±√≠as espec√≠ficas (si aplica)

#### Caracter√≠sticas T√©cnicas:

- Acceso completo a todos los recursos del sistema
- Puede realizar operaciones CRUD en todos los m√≥dulos
- Tiene permisos especiales para gesti√≥n de usuarios y roles
- Puede acceder a datos agregados y estad√≠sticas

---

## Flujos de Trabajo Principales

### Flujo de Cotizaci√≥n

1. **Usuario inicia sesi√≥n** ‚Üí Autenticaci√≥n exitosa
2. **Selecci√≥n de compa√±√≠a** ‚Üí Usuario (cliente, estimador o administrador) selecciona la compa√±√≠a con la que trabajar√°
3. **Cliente se registra** ‚Üí Se crea autom√°ticamente perfil "customer"
4. **PRIMER PASO: Crear Proyecto** ‚Üí El estimador crea un proyecto con informaci√≥n b√°sica (nombre, cliente, compa√±√≠a, estimador)
5. **SEGUNDO PASO: Crear Estimaci√≥n (Versi√≥n 1)** ‚Üí El estimador crea la primera estimaci√≥n/cotizaci√≥n asociada al proyecto creado mediante una interfaz con dos pesta√±as:
   - **Pesta√±a 1 - Formulario Principal**: Completa toda la informaci√≥n t√©cnica del proyecto (dimensiones, especificaciones, precios, etc.)
   - **Pesta√±a 2 - Gesti√≥n de Materiales**: Ingresa la lista de materiales mediante:
     - Subida de archivo de imagen/PDF con la lista, o
     - Ingreso manual de cada material con cantidad y descripci√≥n
6. **Cliente revisa estimaci√≥n** ‚Üí Puede ver el detalle completo y todas las versiones disponibles del proyecto (solo de la compa√±√≠a seleccionada)
7. **Cliente solicita cambios** ‚Üí Puede aprobar, rechazar o solicitar modificaciones adicionales
8. **Estimador actualiza la estimaci√≥n** ‚Üí Al editar, se crea autom√°ticamente una nueva versi√≥n (Versi√≥n 2, 3, etc.) manteniendo la asociaci√≥n con el proyecto y la compa√±√≠a
9. **Cliente revisa nueva versi√≥n** ‚Üí Puede comparar con versiones anteriores y ver los cambios realizados
10. **Proceso iterativo** ‚Üí El ciclo se repite hasta que el cliente apruebe una versi√≥n
11. **Cliente aprueba estimaci√≥n** ‚Üí Una vez aprobada una versi√≥n, se asocia al proyecto mediante `approvedQuoteId` y el proyecto puede iniciarse (dentro del contexto de la compa√±√≠a)

### Flujo de Proyecto

1. **Crear Proyecto** ‚Üí El estimador crea un proyecto con informaci√≥n b√°sica (nombre, cliente, compa√±√≠a, estimador)
2. **Crear Estimaciones** ‚Üí Se crean una o m√∫ltiples estimaciones (quotes) asociadas al proyecto
3. **Revisi√≥n y Aprobaci√≥n** ‚Üí El cliente revisa las estimaciones, solicita cambios si es necesario, y aprueba una versi√≥n
4. **Asociar Estimaci√≥n Aprobada** ‚Üí Cuando se aprueba una estimaci√≥n, se asocia al proyecto mediante `approvedQuoteId`
5. **Proyecto en Progreso** ‚Üí El proyecto se marca como "in_progress" cuando hay una estimaci√≥n aprobada
6. **Estimador reporta avances** ‚Üí Actualiza estado y sube documentaci√≥n
7. **Cliente hace seguimiento** ‚Üí Ve actualizaciones en tiempo real
8. **Pagos se registran** ‚Üí Cliente realiza pagos completos o parciales
9. **Proyecto completado** ‚Üí Se marca como finalizado

### Flujo de Administraci√≥n

1. **Administrador monitorea KPIs** ‚Üí Revisa m√©tricas del dashboard
2. **Analiza rendimiento** ‚Üí Eval√∫a proyectos, estimadores y clientes
3. **Gestiona usuarios** ‚Üí Crea, modifica o desactiva cuentas
4. **Genera reportes** ‚Üí Exporta datos para an√°lisis y toma de decisiones

---

## Arquitectura de Datos

### Entidades Principales

1. **Users (Usuarios)**

   - Informaci√≥n b√°sica: email, nombre, contrase√±a
   - Relaci√≥n con roles

2. **Roles**

   - Tipos: customer, estimator, administrador
   - Asociado a un usuario mediante `userId` (ObjectId)

3. **Quotes (Cotizaciones/Estimaciones)**

   - Informaci√≥n del cliente y compa√±√≠a
   - **Asociada a un proyecto**: Cada cotizaci√≥n pertenece a un proyecto espec√≠fico (`projectId` requerido)
   - Detalles del proyecto (kitchenInformation, materials, etc.)
   - Asociada a un estimador mediante `userId` (ObjectId)
   - **Asociada a una compa√±√≠a**: Cada cotizaci√≥n pertenece a una compa√±√≠a espec√≠fica
   - Categor√≠a: kitchen, bathroom, other
   - Precio total y experiencia
   - **Sistema de versiones**: Cada estimaci√≥n puede tener m√∫ltiples versiones
   - Cada versi√≥n mantiene un registro completo de cambios y fecha de creaci√≥n
   - Las versiones permiten rastrear la evoluci√≥n de cada propuesta
   - Todas las versiones de una cotizaci√≥n pertenecen al mismo proyecto y compa√±√≠a
   - **Campo `materials` (opcional)**: Objeto que permite almacenar la lista de materiales de dos formas:
     - **`file` (string, opcional)**: URL del archivo de imagen/PDF con la lista de materiales
     - **`items` (array, opcional)**: Array de objetos cuando se ingresan manualmente, cada objeto contiene `quantity` (n√∫mero) y `description` (string)
     - Puede contener `file`, `items`, o ambos simult√°neamente

4. **Projects (Proyectos)**

   - Informaci√≥n b√°sica del proyecto (nombre, descripci√≥n)
   - **Asociado a una compa√±√≠a**: Cada proyecto pertenece a una compa√±√≠a espec√≠fica
   - Asociado a un cliente (`customerId`)
   - Asociado a un estimador (`estimatorId`)
   - **Puede tener m√∫ltiples estimaciones**: Un proyecto puede tener varias cotizaciones/estimaciones
   - **Estimaci√≥n aprobada**: Campo `approvedQuoteId` para asociar la estimaci√≥n aprobada
   - Estados: pending, in_progress, on_hold, completed, cancelled
   - Milestones, updates, fotos y documentaci√≥n

5. **Customers (Clientes)**

   - Informaci√≥n de contacto y ubicaci√≥n
   - Historial de proyectos
   - Puede tener proyectos en m√∫ltiples compa√±√≠as
   - Cada proyecto est√° asociado a una compa√±√≠a espec√≠fica

6. **Companies (Compa√±√≠as)**

   - Identificador √∫nico de compa√±√≠a
   - Nombre de la compa√±√≠a
   - Configuraci√≥n espec√≠fica de la compa√±√≠a
   - Asociaci√≥n con proyectos, cotizaciones y usuarios

7. **Payments (Pagos)** - _Futuro_
   - Asociados a proyectos
   - **Asociados a compa√±√≠a**: Cada pago pertenece a la compa√±√≠a del proyecto
   - Montos completos o parciales
   - Fechas y comprobantes
   - Filtrado y reportes por compa√±√≠a

---

## Sistema de Versiones de Estimaciones

La plataforma implementa un sistema robusto de versiones para las estimaciones y proyectos, permitiendo un control completo del historial de cambios y facilitando la colaboraci√≥n entre clientes y estimadores.

### Caracter√≠sticas del Sistema de Versiones

1. **Creaci√≥n Autom√°tica de Versiones**

   - Cada vez que un estimador edita una estimaci√≥n existente, se crea autom√°ticamente una nueva versi√≥n
   - Las versiones anteriores se mantienen intactas y accesibles
   - Cada versi√≥n tiene un n√∫mero secuencial (v1, v2, v3, etc.)

2. **Historial Completo**

   - Todas las versiones de una estimaci√≥n quedan registradas permanentemente
   - Cada versi√≥n incluye:
     - Fecha y hora de creaci√≥n
     - Usuario que realiz√≥ los cambios (estimador)
     - Contenido completo de la estimaci√≥n en ese momento
     - Estado de la versi√≥n (borrador, enviada, aprobada, rechazada)

3. **Visualizaci√≥n para Clientes**

   - Los clientes pueden ver el detalle completo de cada estimaci√≥n
   - Acceso a todas las versiones de las propuestas enviadas
   - Capacidad de comparar diferentes versiones lado a lado
   - Visualizaci√≥n clara de los cambios entre versiones

4. **Solicitud de Cambios**

   - Los clientes pueden solicitar modificaciones adicionales a cualquier versi√≥n
   - Las solicitudes de cambios quedan registradas y asociadas a la versi√≥n espec√≠fica
   - Los estimadores pueden ver qu√© cambios fueron solicitados y en qu√© versi√≥n

5. **Trazabilidad Completa**
   - Registro completo de qui√©n hizo qu√© cambios y cu√°ndo
   - Historial de aprobaciones y rechazos por versi√≥n
   - Seguimiento de todas las interacciones relacionadas con cada versi√≥n

### Beneficios del Sistema de Versiones

- **Transparencia**: Los clientes pueden ver toda la evoluci√≥n de su estimaci√≥n
- **Colaboraci√≥n**: Facilita la comunicaci√≥n y el proceso iterativo de refinamiento
- **Auditor√≠a**: Registro completo de cambios para cumplimiento y an√°lisis
- **Flexibilidad**: Permite m√∫ltiples iteraciones sin perder informaci√≥n previa
- **Comparaci√≥n**: Facilita la comparaci√≥n entre diferentes propuestas y versiones

### Flujo de Versiones

1. **Versi√≥n Inicial**: El estimador crea la primera versi√≥n de la estimaci√≥n
2. **Revisi√≥n del Cliente**: El cliente revisa y puede solicitar cambios
3. **Nueva Versi√≥n**: El estimador edita y se crea autom√°ticamente una nueva versi√≥n
4. **Comparaci√≥n**: El cliente puede comparar la nueva versi√≥n con las anteriores
5. **Aprobaci√≥n**: El cliente aprueba una versi√≥n espec√≠fica, que se convierte en la versi√≥n final

---

## Tecnolog√≠as y Caracter√≠sticas T√©cnicas

### Backend

- **Framework**: NestJS
- **Base de Datos**: MongoDB con Mongoose
- **Autenticaci√≥n**: JWT (JSON Web Tokens) + Passport
- **OAuth**: Integraci√≥n con Google OAuth
- **Validaci√≥n**: class-validator y class-transformer
- **Almacenamiento**: AWS S3 (para archivos multimedia)

### Funcionalidades Especiales

- **Procesamiento de Audio**: Integraci√≥n con OpenAI Whisper para transcripci√≥n y resumen de audio
- **Subida de Archivos**: Soporte para im√°genes, videos y audio (hasta 10MB para archivos generales, 25MB para audio)
- **Validaci√≥n Robusta**: Validaci√≥n autom√°tica de todos los datos de entrada
- **CORS Habilitado**: Permite solicitudes desde cualquier origen

---

## Seguridad y Permisos

### Control de Acceso

- **Customer**: Solo puede acceder a sus propios datos
- **Estimator**: Puede crear y gestionar cotizaciones, ver clientes asignados
- **Administrador**: Acceso completo al sistema

### Autenticaci√≥n

- Registro con email y contrase√±a (m√≠nimo 6 caracteres)
- Login con credenciales locales
- Login con Google OAuth
- Tokens JWT para sesiones
- Refresh tokens para renovaci√≥n de sesiones

---

## Estado Actual del Desarrollo

### M√≥dulos Implementados ‚úÖ

- Autenticaci√≥n y autorizaci√≥n
- Gesti√≥n de usuarios y roles
- Gesti√≥n de clientes
- Creaci√≥n y gesti√≥n de cotizaciones (especialmente cocinas)
- Subida y gesti√≥n de archivos
- Procesamiento de audio

### Funcionalidades Pendientes üöß

- Sistema de pagos completo (integraci√≥n con pasarelas)
- Dashboard con KPIs para administradores (interfaz de usuario)
- **Sistema de selecci√≥n de compa√±√≠a** (interfaz y l√≥gica de contexto en frontend)
- Sistema de notificaciones
- Reportes y exportaci√≥n de datos
- Sistema de mensajer√≠a entre usuarios
- Comparaci√≥n visual de versiones de estimaciones

---

## Pr√≥ximos Pasos Sugeridos

1. **Implementar sistema de pagos**

   - Modelo de datos para pagos
   - Endpoints para registro de pagos
   - Integraci√≥n con pasarelas de pago (opcional)

2. **Desarrollar dashboard de administraci√≥n**

   - Componentes de visualizaci√≥n de KPIs
   - Gr√°ficos y m√©tricas
   - Filtros y b√∫squedas avanzadas

3. **Sistema de seguimiento de proyectos**

   - Estados de proyecto (pendiente, en progreso, completado, etc.)
   - Actualizaciones y hitos
   - Documentaci√≥n fotogr√°fica

4. **Notificaciones**

   - Notificaciones en tiempo real
   - Emails de actualizaci√≥n
   - Alertas de cambios importantes

5. **Expandir tipos de cotizaciones**

   - DTOs espec√≠ficos para ba√±os
   - DTOs para otros tipos de proyectos
   - Plantillas reutilizables

6. **Implementar sistema de versiones completo**

   - Modelo de datos para versiones de estimaciones
   - Endpoints para gesti√≥n de versiones
   - Funcionalidad de comparaci√≥n de versiones
   - Visualizaci√≥n de historial de cambios
   - Sistema de aprobaci√≥n por versi√≥n

7. **Implementar sistema de compa√±√≠as completo**
   - Modelo de datos para compa√±√≠as
   - Sistema de selecci√≥n de compa√±√≠a despu√©s del login
   - Contexto de sesi√≥n por compa√±√≠a
   - Asociaci√≥n de cotizaciones y proyectos con compa√±√≠as
   - Filtrado por compa√±√≠a en todos los endpoints
   - KPIs y reportes por compa√±√≠a
   - Interfaz de usuario para cambio de compa√±√≠a

---

## Contacto y Soporte

Para m√°s informaci√≥n sobre la plataforma, consulta:

- [Documentaci√≥n de API](./API_DOCUMENTATION.md)
- C√≥digo fuente del proyecto
- Equipo de desarrollo

---

**√öltima actualizaci√≥n**: 20 de Noviembre de 2025
