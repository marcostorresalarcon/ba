<section class="space-y-6 rounded-3xl border border-fog/50 bg-white/90 p-6 shadow-brand">
  <header class="flex items-center justify-between">
    <div>
      <p class="text-xs uppercase tracking-[0.35em] text-clay">Homeowner</p>
      <h2 class="font-display text-2xl text-charcoal">
        {{ customer ? 'Edit customer' : 'Create customer' }}
      </h2>
    </div>
    @if (customer) {
      <button
        type="button"
        class="text-sm text-slate underline-offset-4 hover:underline"
        (click)="cancelEdit.emit()"
      >
        Cancel
      </button>
    }
  </header>

  <form class="space-y-4" [formGroup]="form" (ngSubmit)="submit()">
    <div class="grid gap-4 md:grid-cols-2">
      <label class="flex flex-col gap-2 text-left text-sm text-charcoal">
        Name*
        <input
          formControlName="name"
          type="text"
          class="rounded-2xl border bg-white px-4 py-3 focus:border-pine focus:outline-none"
          [class.border-red-500]="hasError('name')"
          [class.border-fog]="!hasError('name')"
          placeholder="Juan"
        />
        @if (hasError('name')) {
          <p class="text-xs text-red-600">{{ getErrorMessage('name') }}</p>
        }
      </label>
      <label class="flex flex-col gap-2 text-left text-sm text-charcoal">
        Last Name*
        <input
          formControlName="lastName"
          type="text"
          class="rounded-2xl border bg-white px-4 py-3 focus:border-pine focus:outline-none"
          [class.border-red-500]="hasError('lastName')"
          [class.border-fog]="!hasError('lastName')"
          placeholder="Rodríguez"
        />
        @if (hasError('lastName')) {
          <p class="text-xs text-red-600">{{ getErrorMessage('lastName') }}</p>
        }
      </label>
    </div>

    <div class="grid gap-4 md:grid-cols-3">
      <label class="flex flex-col gap-2 text-left text-sm text-charcoal">
        Phone
        <input
          formControlName="phone"
          type="tel"
          class="rounded-2xl border bg-white px-4 py-3 focus:border-pine focus:outline-none"
          [class.border-red-500]="hasError('phone')"
          [class.border-fog]="!hasError('phone')"
          placeholder="(123) 456-7890"
        />
        @if (hasError('phone')) {
          <p class="text-xs text-red-600">{{ getErrorMessage('phone') }}</p>
        }
      </label>
      <label class="flex flex-col gap-2 text-left text-sm text-charcoal">
        Date
        <input
          formControlName="date"
          type="date"
          class="rounded-2xl border border-fog bg-white px-4 py-3 focus:border-pine focus:outline-none"
        />
      </label>
      <label class="flex flex-col gap-2 text-left text-sm text-charcoal">
        Email
        <input
          formControlName="email"
          type="email"
          class="rounded-2xl border bg-white px-4 py-3 focus:border-pine focus:outline-none"
          [class.border-red-500]="hasError('email')"
          [class.border-fog]="!hasError('email')"
          placeholder="juan@example.com"
        />
        @if (hasError('email')) {
          <p class="text-xs text-red-600">{{ getErrorMessage('email') }}</p>
        }
      </label>
    </div>

    <label class="flex flex-col gap-2 text-left text-sm text-charcoal">
      Address
      <div #addressContainer class="address-autocomplete-container w-full">
        <!-- PlaceAutocompleteElement se insertará aquí dinámicamente -->
      </div>
      <!-- Input oculto para sincronización con el formulario -->
      <input
        formControlName="address"
        type="hidden"
      />
      <p class="text-xs text-slate">Start typing to search for a US address</p>
    </label>

    <div class="grid gap-4 md:grid-cols-3">
      <label class="flex flex-col gap-2 text-left text-sm text-charcoal">
        City
        <input
          formControlName="city"
          type="text"
          class="rounded-2xl border border-fog bg-white px-4 py-3 focus:border-pine focus:outline-none"
          placeholder="Miami"
        />
      </label>
      <label class="flex flex-col gap-2 text-left text-sm text-charcoal">
        Zip Code
        <input
          formControlName="zipCode"
          type="text"
          class="rounded-2xl border border-fog bg-white px-4 py-3 focus:border-pine focus:outline-none"
          placeholder="33130"
        />
      </label>
      <label class="flex flex-col gap-2 text-left text-sm text-charcoal">
        State
        <input
          formControlName="state"
          type="text"
          class="rounded-2xl border border-fog bg-white px-4 py-3 focus:border-pine focus:outline-none"
          placeholder="Florida"
        />
      </label>
    </div>

    <label class="flex flex-col gap-2 text-left text-sm text-charcoal">
      Lead Source
      <select
        formControlName="leadSource"
        class="rounded-2xl border border-fog bg-white px-4 py-3 focus:border-pine focus:outline-none text-charcoal"
      >
        <option value="">Select a lead source</option>
        <option value="Google Ads">Google Ads</option>
        <option value="Meta Ads">Meta Ads</option>
        <option value="Walk-in">Walk-in</option>
        <option value="Referrals">Referrals</option>
      </select>
    </label>

    <label class="flex flex-col gap-2 text-left text-sm text-charcoal">
      Description
      <textarea
        formControlName="description"
        rows="3"
        class="rounded-2xl border border-fog bg-white px-4 py-3 focus:border-pine focus:outline-none"
        placeholder="Add context or project notes"
      ></textarea>
    </label>

    <button
      type="submit"
      class="w-full rounded-2xl bg-pine py-3 text-lg font-semibold text-white transition hover:bg-pine-dark disabled:cursor-not-allowed disabled:opacity-60"
      [disabled]="isSubmitting"
    >
      {{ customer ? 'Update' : 'Create' }}
    </button>
  </form>
</section>


