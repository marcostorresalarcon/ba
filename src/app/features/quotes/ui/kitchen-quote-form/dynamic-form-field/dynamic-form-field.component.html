@if (control(); as ctrl) {
<div class="flex flex-col gap-2">
  <!-- Label (no mostrar para checkbox, ya que el label estÃ¡ dentro del checkbox) -->
  @if (input.element !== 'checkbox') {
  <label class="text-sm font-semibold text-charcoal">
    {{ capitalizeFirstLetter(input.label) }}
    @if (input.unit) {
    <span class="text-xs text-clay">({{ input.unit }})</span>
    }
  </label>
  }

  <!-- Number Input -->
  @if (input.element === 'numberInput') {
  <input
    type="number"
    [formControl]="ctrl"
    class="rounded-lg border border-fog/60 bg-white px-4 py-2 text-charcoal transition focus:border-pine focus:outline-none"
    [placeholder]="input.unit ? `Enter ${input.unit}` : 'Enter value'"
    (blur)="onNumberChange(getNumberValue(ctrl.value))"
  />
  }

  <!-- Radio Button -->
  @if (input.element === 'radioButton') {
  <div class="flex flex-wrap gap-3">
    @for (selection of input.selections; track selection) {
    <label class="flex cursor-pointer items-center gap-2">
      <input
        type="radio"
        [name]="input.name"
        [formControl]="ctrl"
        [value]="selection"
        (change)="onRadioChange(selection)"
        class="h-4 w-4 text-pine"
      />
      <span class="text-sm text-charcoal">{{ selection }}</span>
    </label>
    }

    <!-- Custom option if custom is true -->
    @if (hasCustomOption()) {
    <label class="flex cursor-pointer items-center gap-2">
      <input
        type="radio"
        [name]="input.name"
        [formControl]="ctrl"
        value="custom"
        (change)="onRadioChange('custom')"
        class="h-4 w-4 text-pine"
      />
      <span class="text-sm text-charcoal">Custom</span>
    </label>
    }
  </div>

  <!-- Custom input field -->
  @if (showCustomInput() && customControl(); as customCtrl) {
  <div class="mt-3 flex flex-col gap-2">
    <label class="text-xs font-medium text-clay">Custom Value</label>
    <div class="relative">
      <input
        type="number"
        [formControl]="customCtrl"
        [min]="0"
        [step]="0.1"
        class="peer w-full rounded-lg border border-fog/60 bg-white px-4 py-2 pr-16 text-charcoal transition focus:border-pine focus:outline-none"
        [placeholder]="`Enter custom ${input.unit || 'value'}`"
      />
      @if (input.unit) {
      <span
        class="pointer-events-none absolute inset-y-0 right-4 flex items-center text-xs font-bold uppercase tracking-wide text-slate/70 peer-focus:text-pine"
      >
        {{ input.unit }}
      </span>
      }
    </div>
  </div>
  }

  <!-- Quantity input for radioButton with UNIT * PRICE formula -->
  @if (input.element === 'radioButton' && (input.formula === 'UNIT * PRICE' || input.formula === 'Selection Price/UNIT * PRICE') && quantityControl(); as qtyCtrl) {
  <div class="mt-3 flex flex-col gap-2">
    <label class="text-xs font-medium text-clay">
      Quantity @if (input.unit) {
      <span class="text-xs text-slate">({{ input.unit }})</span>
      }
    </label>
    <div class="relative">
      <input
        type="number"
        [formControl]="qtyCtrl"
        min="1"
        step="1"
        class="peer w-full rounded-lg border border-fog/60 bg-white px-4 py-2 pr-16 text-charcoal transition focus:border-pine focus:outline-none disabled:cursor-not-allowed disabled:bg-fog/20 disabled:text-slate"
        [placeholder]="input.unit ? `Enter ${input.unit}` : 'Enter quantity'"
      />
      @if (input.unit) {
      <span
        class="pointer-events-none absolute inset-y-0 right-4 flex items-center text-xs font-bold uppercase tracking-wide text-slate/70 peer-focus:text-pine"
      >
        {{ input.unit }}
      </span>
      }
    </div>
  </div>
  }
  }

  <!-- Checkbox -->
  @if (input.element === 'checkbox') {
  <label class="flex cursor-pointer items-center gap-2">
    <input
      type="checkbox"
      [formControl]="ctrl"
      [checked]="ctrl.value === true"
      (change)="onCheckboxChange($event)"
      class="h-4 w-4 rounded border-fog/60 text-pine"
    />
    <span class="text-sm text-charcoal">{{ capitalizeFirstLetter(input.label) }}</span>
  </label>
  }

  <!-- Select -->
  @if (input.element === 'select' || input.element === 'selectCustomInputText') {
  <select
    [formControl]="ctrl"
    class="rounded-lg border border-fog/60 bg-white px-4 py-2 text-charcoal transition focus:border-pine focus:outline-none"
    (change)="onSelectChange($event)"
  >
    <option value="">Select an option</option>
    @for (selection of input.selections; track selection) {
    <option [value]="selection">{{ selection }}</option>
    }
    <!-- Custom option if custom is true -->
    @if (hasCustomOption()) {
    <option value="custom">Custom</option>
    }
  </select>

  <!-- Custom input field for selectCustomInputText -->
  @if (input.element === 'selectCustomInputText' && showCustomInput() && customControl(); as
  customCtrl) {
  <div class="mt-3 flex flex-col gap-2">
    <label class="text-xs font-medium text-clay">Custom Value</label>
    <div class="relative">
      <input
        type="number"
        [formControl]="customCtrl"
        [min]="0"
        [step]="0.1"
        class="peer w-full rounded-lg border border-fog/60 bg-white px-4 py-2 pr-16 text-charcoal transition focus:border-pine focus:outline-none"
        [placeholder]="`Enter custom ${input.unit || 'value'}`"
      />
      @if (input.unit) {
      <span
        class="pointer-events-none absolute inset-y-0 right-4 flex items-center text-xs font-bold uppercase tracking-wide text-slate/70 peer-focus:text-pine"
      >
        {{ input.unit }}
      </span>
      }
    </div>
  </div>
  } }

  <!-- Textarea (inputFileTextArea) -->
  @if (input.element === 'inputFileTextArea') {
  <textarea
    [formControl]="ctrl"
    rows="3"
    class="rounded-lg border border-fog/60 bg-white px-4 py-2 text-charcoal transition focus:border-pine focus:outline-none"
    [placeholder]="`Enter ${input.label.toLowerCase()}`"
  ></textarea>
  }
</div>
}
